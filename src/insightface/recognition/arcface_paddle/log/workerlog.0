Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 41, in <module>
    paddle.fluid.set_flags(RELATED_FLAGS_SETTING)
    ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 41, in <module>
    paddle.fluid.set_flags(RELATED_FLAGS_SETTING)
    ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-13 12:37:04,757] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:37:04,757 - rank: 0
[2025-03-13 12:37:04,757] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:37:04,757 - --------args----------
[2025-03-13 12:37:04,757] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:37:04,757 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:37:04,757] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:37:04,757 - is_static: True
[2025-03-13 12:37:04,757] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:37:04,757 - backbone: FresResNet50
[2025-03-13 12:37:04,757] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:37:04,757 - classifier: LargeScaleClassifier
[2025-03-13 12:37:04,757] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:37:04,757 - embedding_size: 512
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:37:04,758 - model_parallel: True
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:37:04,758 - sample_ratio: 0.1
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:37:04,758 - loss: ArcFace
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:37:04,758 - dropout: 0.0
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:37:04,758 - fp16: True
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:37:04,758 - init_loss_scaling: 27648.0
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:37:04,758 - max_loss_scaling: 128.0
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:37:04,758 - incr_every_n_steps: 2000
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:37:04,758 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:37:04,758 - incr_ratio: 2.0
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:37:04,758 - decr_ratio: 0.5
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:37:04,758 - use_dynamic_loss_scaling: True
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:37:04,758 - custom_white_list: []
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:37:04,758 - custom_black_list: []
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:37:04,758 - lr: 0.01
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:37:04,758 - lr_decay: 0.1
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:37:04,758 - weight_decay: 0.0005
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:37:04,758 - momentum: 0.9
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:37:04,758 - train_unit: epoch
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:37:04,758 - warmup_num: 0
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:37:04,758 - train_num: 25
[2025-03-13 12:37:04,758] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:37:04,758 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:37:04,759 - use_synthetic_dataset: False
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:37:04,759 - dataset: custom_dataset
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:37:04,759 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:37:04,759 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:37:04,759 - is_bin: False
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:37:04,759 - num_classes: 306
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:37:04,759 - batch_size: 64
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:37:04,759 - num_workers: 8
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:37:04,759 - do_validation_while_train: False
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:37:04,759 - validation_interval_step: 2000
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:37:04,759 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:37:04,759 - logdir: ./log
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:37:04,759 - log_interval_step: 100
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:37:04,759 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:37:04,759 - resume: False
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:37:04,759 - checkpoint_dir: None
[2025-03-13 12:37:04,759] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:37:04,759 - max_num_last_checkpoint: 1
[2025-03-13 12:37:04,759] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:37:04,759 - ------------------------

[2025-03-13 12:37:04,761] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:37:04,761 - read label file finished, total num: 4932
[2025-03-13 12:37:04,761] [    INFO] train.py:81 - world_size: 1
Training: 2025-03-13 12:37:04,761 - world_size: 1
[2025-03-13 12:37:04,761] [    INFO] train.py:82 - total_batch_size: 64
Training: 2025-03-13 12:37:04,761 - total_batch_size: 64
[2025-03-13 12:37:04,761] [    INFO] train.py:83 - warmup_steps: 0
Training: 2025-03-13 12:37:04,761 - warmup_steps: 0
[2025-03-13 12:37:04,762] [    INFO] train.py:84 - steps_per_epoch: 77
Training: 2025-03-13 12:37:04,762 - steps_per_epoch: 77
[2025-03-13 12:37:04,762] [    INFO] train.py:85 - total_steps: 1925
Training: 2025-03-13 12:37:04,762 - total_steps: 1925
[2025-03-13 12:37:04,762] [    INFO] train.py:86 - total_epoch: 25
Training: 2025-03-13 12:37:04,762 - total_epoch: 25
[2025-03-13 12:37:04,762] [    INFO] train.py:87 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:37:04,762 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 103, in train
    margin_loss_params = eval(f"losses.{args.loss}")()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
NameError: name 'losses' is not defined
[2025-03-13 12:44:16,535] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:44:16,535 - rank: 0
[2025-03-13 12:44:16,535] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:44:16,535 - --------args----------
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:44:16,535 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:44:16,535 - is_static: True
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:44:16,535 - backbone: FresResNet50
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:44:16,535 - classifier: LargeScaleClassifier
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:44:16,535 - embedding_size: 512
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:44:16,535 - model_parallel: True
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:44:16,535 - sample_ratio: 0.1
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:44:16,535 - loss: ArcFace
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:44:16,535 - dropout: 0.0
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:44:16,535 - fp16: True
[2025-03-13 12:44:16,535] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:44:16,535 - init_loss_scaling: 27648.0
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:44:16,536 - max_loss_scaling: 128.0
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:44:16,536 - incr_every_n_steps: 2000
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:44:16,536 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:44:16,536 - incr_ratio: 2.0
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:44:16,536 - decr_ratio: 0.5
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:44:16,536 - use_dynamic_loss_scaling: True
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:44:16,536 - custom_white_list: []
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:44:16,536 - custom_black_list: []
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:44:16,536 - lr: 0.01
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:44:16,536 - lr_decay: 0.1
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:44:16,536 - weight_decay: 0.0005
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:44:16,536 - momentum: 0.9
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:44:16,536 - train_unit: epoch
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:44:16,536 - warmup_num: 0
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:44:16,536 - train_num: 25
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:44:16,536 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:44:16,536 - use_synthetic_dataset: False
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:44:16,536 - dataset: custom_dataset
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:44:16,536 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:44:16,536 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:44:16,536] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:44:16,536 - is_bin: False
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:44:16,537 - num_classes: 306
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:44:16,537 - batch_size: 64
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:44:16,537 - num_workers: 8
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:44:16,537 - do_validation_while_train: False
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:44:16,537 - validation_interval_step: 2000
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:44:16,537 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:44:16,537 - logdir: ./log
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:44:16,537 - log_interval_step: 100
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:44:16,537 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:44:16,537 - resume: False
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:44:16,537 - checkpoint_dir: None
[2025-03-13 12:44:16,537] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:44:16,537 - max_num_last_checkpoint: 1
[2025-03-13 12:44:16,537] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:44:16,537 - ------------------------

[2025-03-13 12:44:16,538] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:44:16,538 - read label file finished, total num: 4932
[2025-03-13 12:44:16,539] [    INFO] train.py:79 - world_size: 1
Training: 2025-03-13 12:44:16,539 - world_size: 1
[2025-03-13 12:44:16,539] [    INFO] train.py:80 - total_batch_size: 64
Training: 2025-03-13 12:44:16,539 - total_batch_size: 64
[2025-03-13 12:44:16,539] [    INFO] train.py:81 - warmup_steps: 0
Training: 2025-03-13 12:44:16,539 - warmup_steps: 0
[2025-03-13 12:44:16,539] [    INFO] train.py:82 - steps_per_epoch: 77
Training: 2025-03-13 12:44:16,539 - steps_per_epoch: 77
[2025-03-13 12:44:16,539] [    INFO] train.py:83 - total_steps: 1925
Training: 2025-03-13 12:44:16,539 - total_steps: 1925
[2025-03-13 12:44:16,539] [    INFO] train.py:84 - total_epoch: 25
Training: 2025-03-13 12:44:16,539 - total_epoch: 25
[2025-03-13 12:44:16,539] [    INFO] train.py:85 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:44:16,539 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 98, in train
    margin_loss_params = eval(f"losses.{args.loss}")()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
NameError: name 'losses' is not defined
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 19, in <module>
    import losses  # Add this line near the other imports
    ^^^^^^^^^^^^^
ModuleNotFoundError: No module named 'losses'
[2025-03-13 12:47:56,241] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:47:56,241 - rank: 0
[2025-03-13 12:47:56,242] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:47:56,242 - --------args----------
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:47:56,242 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:47:56,242 - is_static: True
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:47:56,242 - backbone: FresResNet50
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:47:56,242 - classifier: LargeScaleClassifier
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:47:56,242 - embedding_size: 512
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:47:56,242 - model_parallel: True
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:47:56,242 - sample_ratio: 0.1
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:47:56,242 - loss: ArcFace
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:47:56,242 - dropout: 0.0
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:47:56,242 - fp16: True
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:47:56,242 - init_loss_scaling: 27648.0
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:47:56,242 - max_loss_scaling: 128.0
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:47:56,242 - incr_every_n_steps: 2000
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:47:56,242 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:47:56,242 - incr_ratio: 2.0
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:47:56,242 - decr_ratio: 0.5
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:47:56,242 - use_dynamic_loss_scaling: True
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:47:56,242 - custom_white_list: []
[2025-03-13 12:47:56,242] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:47:56,242 - custom_black_list: []
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:47:56,243 - lr: 0.01
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:47:56,243 - lr_decay: 0.1
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:47:56,243 - weight_decay: 0.0005
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:47:56,243 - momentum: 0.9
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:47:56,243 - train_unit: epoch
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:47:56,243 - warmup_num: 0
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:47:56,243 - train_num: 25
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:47:56,243 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:47:56,243 - use_synthetic_dataset: False
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:47:56,243 - dataset: custom_dataset
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:47:56,243 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:47:56,243 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:47:56,243 - is_bin: False
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:47:56,243 - num_classes: 306
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:47:56,243 - batch_size: 64
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:47:56,243 - num_workers: 8
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:47:56,243 - do_validation_while_train: False
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:47:56,243 - validation_interval_step: 2000
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:47:56,243 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:47:56,243 - logdir: ./log
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:47:56,243 - log_interval_step: 100
[2025-03-13 12:47:56,243] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:47:56,243 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:47:56,244] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:47:56,244 - resume: False
[2025-03-13 12:47:56,244] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:47:56,244 - checkpoint_dir: None
[2025-03-13 12:47:56,244] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:47:56,244 - max_num_last_checkpoint: 1
[2025-03-13 12:47:56,244] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:47:56,244 - ------------------------

[2025-03-13 12:47:56,245] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:47:56,245 - read label file finished, total num: 4932
[2025-03-13 12:47:56,245] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 12:47:56,245 - world_size: 1
[2025-03-13 12:47:56,245] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 12:47:56,245 - total_batch_size: 64
[2025-03-13 12:47:56,245] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 12:47:56,245 - warmup_steps: 0
[2025-03-13 12:47:56,245] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 12:47:56,245 - steps_per_epoch: 77
[2025-03-13 12:47:56,245] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 12:47:56,245 - total_steps: 1925
[2025-03-13 12:47:56,246] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 12:47:56,246 - total_epoch: 25
[2025-03-13 12:47:56,246] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:47:56,246 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 86, in __init__
    self.classifier = eval("classifiers.{}".format(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 110, in __init__
    norm_feature = paddle.fluid.layers.l2_normalize(total_feature, axis=1)
                   ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-13 12:50:56,814] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:50:56,814 - rank: 0
[2025-03-13 12:50:56,815] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:50:56,815 - --------args----------
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:50:56,815 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:50:56,815 - is_static: True
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:50:56,815 - backbone: FresResNet50
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:50:56,815 - classifier: LargeScaleClassifier
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:50:56,815 - embedding_size: 512
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:50:56,815 - model_parallel: True
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:50:56,815 - sample_ratio: 0.1
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:50:56,815 - loss: ArcFace
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:50:56,815 - dropout: 0.0
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:50:56,815 - fp16: True
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:50:56,815 - init_loss_scaling: 27648.0
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:50:56,815 - max_loss_scaling: 128.0
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:50:56,815 - incr_every_n_steps: 2000
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:50:56,815 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:50:56,815 - incr_ratio: 2.0
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:50:56,815 - decr_ratio: 0.5
[2025-03-13 12:50:56,815] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:50:56,815 - use_dynamic_loss_scaling: True
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:50:56,816 - custom_white_list: []
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:50:56,816 - custom_black_list: []
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:50:56,816 - lr: 0.01
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:50:56,816 - lr_decay: 0.1
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:50:56,816 - weight_decay: 0.0005
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:50:56,816 - momentum: 0.9
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:50:56,816 - train_unit: epoch
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:50:56,816 - warmup_num: 0
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:50:56,816 - train_num: 25
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:50:56,816 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:50:56,816 - use_synthetic_dataset: False
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:50:56,816 - dataset: custom_dataset
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:50:56,816 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:50:56,816 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:50:56,816 - is_bin: False
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:50:56,816 - num_classes: 306
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:50:56,816 - batch_size: 64
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:50:56,816 - num_workers: 8
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:50:56,816 - do_validation_while_train: False
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:50:56,816 - validation_interval_step: 2000
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:50:56,816 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:50:56,816] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:50:56,816 - logdir: ./log
[2025-03-13 12:50:56,817] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:50:56,817 - log_interval_step: 100
[2025-03-13 12:50:56,817] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:50:56,817 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:50:56,817] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:50:56,817 - resume: False
[2025-03-13 12:50:56,817] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:50:56,817 - checkpoint_dir: None
[2025-03-13 12:50:56,817] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:50:56,817 - max_num_last_checkpoint: 1
[2025-03-13 12:50:56,817] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:50:56,817 - ------------------------

[2025-03-13 12:50:56,818] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:50:56,818 - read label file finished, total num: 4932
[2025-03-13 12:50:56,818] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 12:50:56,818 - world_size: 1
[2025-03-13 12:50:56,819] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 12:50:56,819 - total_batch_size: 64
[2025-03-13 12:50:56,819] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 12:50:56,819 - warmup_steps: 0
[2025-03-13 12:50:56,819] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 12:50:56,819 - steps_per_epoch: 77
[2025-03-13 12:50:56,819] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 12:50:56,819 - total_steps: 1925
[2025-03-13 12:50:56,819] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 12:50:56,819 - total_epoch: 25
[2025-03-13 12:50:56,819] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:50:56,819 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 86, in __init__
    self.classifier = eval("classifiers.{}".format(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 111, in __init__
    norm_weight = paddle.fluid.layers.l2_normalize(weight, axis=0)
                  ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-13 12:53:39,529] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:53:39,529 - rank: 0
[2025-03-13 12:53:39,530] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:53:39,530 - --------args----------
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:53:39,530 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:53:39,530 - is_static: True
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:53:39,530 - backbone: FresResNet50
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:53:39,530 - classifier: LargeScaleClassifier
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:53:39,530 - embedding_size: 512
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:53:39,530 - model_parallel: True
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:53:39,530 - sample_ratio: 0.1
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:53:39,530 - loss: ArcFace
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:53:39,530 - dropout: 0.0
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:53:39,530 - fp16: True
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:53:39,530 - init_loss_scaling: 27648.0
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:53:39,530 - max_loss_scaling: 128.0
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:53:39,530 - incr_every_n_steps: 2000
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:53:39,530 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:53:39,530 - incr_ratio: 2.0
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:53:39,530 - decr_ratio: 0.5
[2025-03-13 12:53:39,530] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:53:39,530 - use_dynamic_loss_scaling: True
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:53:39,531 - custom_white_list: []
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:53:39,531 - custom_black_list: []
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:53:39,531 - lr: 0.01
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:53:39,531 - lr_decay: 0.1
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:53:39,531 - weight_decay: 0.0005
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:53:39,531 - momentum: 0.9
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:53:39,531 - train_unit: epoch
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:53:39,531 - warmup_num: 0
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:53:39,531 - train_num: 25
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:53:39,531 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:53:39,531 - use_synthetic_dataset: False
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:53:39,531 - dataset: custom_dataset
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:53:39,531 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:53:39,531 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:53:39,531 - is_bin: False
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:53:39,531 - num_classes: 306
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:53:39,531 - batch_size: 64
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:53:39,531 - num_workers: 8
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:53:39,531 - do_validation_while_train: False
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:53:39,531 - validation_interval_step: 2000
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:53:39,531 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:53:39,531] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:53:39,531 - logdir: ./log
[2025-03-13 12:53:39,532] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:53:39,532 - log_interval_step: 100
[2025-03-13 12:53:39,532] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:53:39,532 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:53:39,532] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:53:39,532 - resume: False
[2025-03-13 12:53:39,532] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:53:39,532 - checkpoint_dir: None
[2025-03-13 12:53:39,532] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:53:39,532 - max_num_last_checkpoint: 1
[2025-03-13 12:53:39,532] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:53:39,532 - ------------------------

[2025-03-13 12:53:39,533] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:53:39,533 - read label file finished, total num: 4932
[2025-03-13 12:53:39,533] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 12:53:39,533 - world_size: 1
[2025-03-13 12:53:39,533] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 12:53:39,533 - total_batch_size: 64
[2025-03-13 12:53:39,534] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 12:53:39,534 - warmup_steps: 0
[2025-03-13 12:53:39,534] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 12:53:39,534 - steps_per_epoch: 77
[2025-03-13 12:53:39,534] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 12:53:39,534 - total_steps: 1925
[2025-03-13 12:53:39,534] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 12:53:39,534 - total_epoch: 25
[2025-03-13 12:53:39,534] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:53:39,534 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 86, in __init__
    self.classifier = eval("classifiers.{}".format(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 126, in __init__
    loss.desc.set_dtype(paddle.fluid.core.VarDesc.VarType.FP32)
                        ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-13 12:55:48,783] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 12:55:48,783 - rank: 0
[2025-03-13 12:55:48,783] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 12:55:48,783 - --------args----------
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 12:55:48,783 - config_file: configs/my_custom_dataset.py
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 12:55:48,783 - is_static: True
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 12:55:48,783 - backbone: FresResNet50
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 12:55:48,783 - classifier: LargeScaleClassifier
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 12:55:48,783 - embedding_size: 512
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 12:55:48,783 - model_parallel: True
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 12:55:48,783 - sample_ratio: 0.1
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 12:55:48,783 - loss: ArcFace
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 12:55:48,783 - dropout: 0.0
[2025-03-13 12:55:48,783] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 12:55:48,783 - fp16: True
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 12:55:48,784 - init_loss_scaling: 27648.0
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 12:55:48,784 - max_loss_scaling: 128.0
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 12:55:48,784 - incr_every_n_steps: 2000
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 12:55:48,784 - decr_every_n_nan_or_inf: 1
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 12:55:48,784 - incr_ratio: 2.0
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 12:55:48,784 - decr_ratio: 0.5
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 12:55:48,784 - use_dynamic_loss_scaling: True
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 12:55:48,784 - custom_white_list: []
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 12:55:48,784 - custom_black_list: []
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 12:55:48,784 - lr: 0.01
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 12:55:48,784 - lr_decay: 0.1
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 12:55:48,784 - weight_decay: 0.0005
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 12:55:48,784 - momentum: 0.9
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 12:55:48,784 - train_unit: epoch
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 12:55:48,784 - warmup_num: 0
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 12:55:48,784 - train_num: 25
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 12:55:48,784 - decay_boundaries: [10, 16, 22]
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 12:55:48,784 - use_synthetic_dataset: False
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 12:55:48,784 - dataset: custom_dataset
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 12:55:48,784 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 12:55:48,784 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 12:55:48,784 - is_bin: False
[2025-03-13 12:55:48,784] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 12:55:48,784 - num_classes: 306
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 12:55:48,785 - batch_size: 64
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 12:55:48,785 - num_workers: 8
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 12:55:48,785 - do_validation_while_train: False
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 12:55:48,785 - validation_interval_step: 2000
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 12:55:48,785 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 12:55:48,785 - logdir: ./log
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 12:55:48,785 - log_interval_step: 100
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 12:55:48,785 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 12:55:48,785 - resume: False
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 12:55:48,785 - checkpoint_dir: None
[2025-03-13 12:55:48,785] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 12:55:48,785 - max_num_last_checkpoint: 1
[2025-03-13 12:55:48,785] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 12:55:48,785 - ------------------------

[2025-03-13 12:55:48,786] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 12:55:48,786 - read label file finished, total num: 4932
[2025-03-13 12:55:48,787] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 12:55:48,787 - world_size: 1
[2025-03-13 12:55:48,787] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 12:55:48,787 - total_batch_size: 64
[2025-03-13 12:55:48,787] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 12:55:48,787 - warmup_steps: 0
[2025-03-13 12:55:48,787] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 12:55:48,787 - steps_per_epoch: 77
[2025-03-13 12:55:48,787] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 12:55:48,787 - total_steps: 1925
[2025-03-13 12:55:48,787] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 12:55:48,787 - total_epoch: 25
[2025-03-13 12:55:48,787] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 12:55:48,787 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 108, in __init__
    self.optimizer = paddle.static.amp.decorate(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/function_overload.py", line 56, in __call__
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
TypeError: decorate() got an unexpected keyword argument 'use_pure_fp16'
[2025-03-13 13:09:24,135] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:09:24,135 - rank: 0
[2025-03-13 13:09:24,135] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:09:24,135 - --------args----------
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:09:24,135 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:09:24,135 - is_static: True
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:09:24,135 - backbone: FresResNet50
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:09:24,135 - classifier: LargeScaleClassifier
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:09:24,135 - embedding_size: 512
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:09:24,135 - model_parallel: True
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:09:24,135 - sample_ratio: 0.1
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:09:24,135 - loss: ArcFace
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:09:24,135 - dropout: 0.0
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:09:24,135 - fp16: True
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:09:24,135 - init_loss_scaling: 27648.0
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:09:24,135 - max_loss_scaling: 128.0
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:09:24,135 - incr_every_n_steps: 2000
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:09:24,135 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:09:24,135 - incr_ratio: 2.0
[2025-03-13 13:09:24,135] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:09:24,135 - decr_ratio: 0.5
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:09:24,136 - use_dynamic_loss_scaling: True
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:09:24,136 - custom_white_list: []
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:09:24,136 - custom_black_list: []
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:09:24,136 - lr: 0.01
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:09:24,136 - lr_decay: 0.1
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:09:24,136 - weight_decay: 0.0005
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:09:24,136 - momentum: 0.9
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:09:24,136 - train_unit: epoch
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:09:24,136 - warmup_num: 0
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:09:24,136 - train_num: 25
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:09:24,136 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:09:24,136 - use_synthetic_dataset: False
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:09:24,136 - dataset: custom_dataset
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:09:24,136 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:09:24,136 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:09:24,136 - is_bin: False
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:09:24,136 - num_classes: 306
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:09:24,136 - batch_size: 64
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:09:24,136 - num_workers: 8
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:09:24,136 - do_validation_while_train: False
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:09:24,136 - validation_interval_step: 2000
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:09:24,136 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:09:24,136] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:09:24,136 - logdir: ./log
[2025-03-13 13:09:24,137] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:09:24,137 - log_interval_step: 100
[2025-03-13 13:09:24,137] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:09:24,137 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:09:24,137] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:09:24,137 - resume: False
[2025-03-13 13:09:24,137] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:09:24,137 - checkpoint_dir: None
[2025-03-13 13:09:24,137] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:09:24,137 - max_num_last_checkpoint: 1
[2025-03-13 13:09:24,137] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:09:24,137 - ------------------------

[2025-03-13 13:09:24,138] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:09:24,138 - read label file finished, total num: 4932
[2025-03-13 13:09:24,138] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:09:24,138 - world_size: 1
[2025-03-13 13:09:24,138] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:09:24,138 - total_batch_size: 64
[2025-03-13 13:09:24,139] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:09:24,139 - warmup_steps: 0
[2025-03-13 13:09:24,139] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:09:24,139 - steps_per_epoch: 77
[2025-03-13 13:09:24,139] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:09:24,139 - total_steps: 1925
[2025-03-13 13:09:24,139] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:09:24,139 - total_epoch: 25
[2025-03-13 13:09:24,139] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:09:24,139 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 68, in __init__
    self.backbone = eval(f"backbones.{self.backbone_class_name}")(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
NameError: name 'backbones' is not defined
[2025-03-13 13:12:57,739] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:12:57,739 - rank: 0
[2025-03-13 13:12:57,739] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:12:57,739 - --------args----------
[2025-03-13 13:12:57,739] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:12:57,739 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:12:57,739] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:12:57,739 - is_static: True
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:12:57,740 - backbone: FresResNet50
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:12:57,740 - classifier: LargeScaleClassifier
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:12:57,740 - embedding_size: 512
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:12:57,740 - model_parallel: True
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:12:57,740 - sample_ratio: 0.1
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:12:57,740 - loss: ArcFace
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:12:57,740 - dropout: 0.0
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:12:57,740 - fp16: True
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:12:57,740 - init_loss_scaling: 27648.0
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:12:57,740 - max_loss_scaling: 128.0
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:12:57,740 - incr_every_n_steps: 2000
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:12:57,740 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:12:57,740 - incr_ratio: 2.0
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:12:57,740 - decr_ratio: 0.5
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:12:57,740 - use_dynamic_loss_scaling: True
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:12:57,740 - custom_white_list: []
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:12:57,740 - custom_black_list: []
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:12:57,740 - lr: 0.01
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:12:57,740 - lr_decay: 0.1
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:12:57,740 - weight_decay: 0.0005
[2025-03-13 13:12:57,740] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:12:57,740 - momentum: 0.9
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:12:57,741 - train_unit: epoch
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:12:57,741 - warmup_num: 0
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:12:57,741 - train_num: 25
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:12:57,741 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:12:57,741 - use_synthetic_dataset: False
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:12:57,741 - dataset: custom_dataset
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:12:57,741 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:12:57,741 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:12:57,741 - is_bin: False
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:12:57,741 - num_classes: 306
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:12:57,741 - batch_size: 64
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:12:57,741 - num_workers: 8
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:12:57,741 - do_validation_while_train: False
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:12:57,741 - validation_interval_step: 2000
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:12:57,741 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:12:57,741 - logdir: ./log
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:12:57,741 - log_interval_step: 100
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:12:57,741 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:12:57,741 - resume: False
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:12:57,741 - checkpoint_dir: None
[2025-03-13 13:12:57,741] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:12:57,741 - max_num_last_checkpoint: 1
[2025-03-13 13:12:57,741] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:12:57,741 - ------------------------

[2025-03-13 13:12:57,743] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:12:57,743 - read label file finished, total num: 4932
[2025-03-13 13:12:57,743] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:12:57,743 - world_size: 1
[2025-03-13 13:12:57,743] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:12:57,743 - total_batch_size: 64
[2025-03-13 13:12:57,744] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:12:57,744 - warmup_steps: 0
[2025-03-13 13:12:57,744] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:12:57,744 - steps_per_epoch: 77
[2025-03-13 13:12:57,744] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:12:57,744 - total_steps: 1925
[2025-03-13 13:12:57,744] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:12:57,744 - total_epoch: 25
[2025-03-13 13:12:57,744] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:12:57,744 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 74, in __init__
    self.classifier = eval(f"classifiers.{self.classifier_class_name}")(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
NameError: name 'classifiers' is not defined
[2025-03-13 13:14:08,924] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:14:08,924 - rank: 0
[2025-03-13 13:14:08,924] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:14:08,924 - --------args----------
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:14:08,924 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:14:08,924 - is_static: True
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:14:08,924 - backbone: FresResNet50
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:14:08,924 - classifier: LargeScaleClassifier
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:14:08,924 - embedding_size: 512
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:14:08,924 - model_parallel: True
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:14:08,924 - sample_ratio: 0.1
[2025-03-13 13:14:08,924] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:14:08,924 - loss: ArcFace
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:14:08,925 - dropout: 0.0
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:14:08,925 - fp16: True
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:14:08,925 - init_loss_scaling: 27648.0
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:14:08,925 - max_loss_scaling: 128.0
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:14:08,925 - incr_every_n_steps: 2000
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:14:08,925 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:14:08,925 - incr_ratio: 2.0
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:14:08,925 - decr_ratio: 0.5
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:14:08,925 - use_dynamic_loss_scaling: True
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:14:08,925 - custom_white_list: []
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:14:08,925 - custom_black_list: []
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:14:08,925 - lr: 0.01
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:14:08,925 - lr_decay: 0.1
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:14:08,925 - weight_decay: 0.0005
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:14:08,925 - momentum: 0.9
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:14:08,925 - train_unit: epoch
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:14:08,925 - warmup_num: 0
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:14:08,925 - train_num: 25
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:14:08,925 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:14:08,925 - use_synthetic_dataset: False
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:14:08,925 - dataset: custom_dataset
[2025-03-13 13:14:08,925] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:14:08,925 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:14:08,926 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:14:08,926 - is_bin: False
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:14:08,926 - num_classes: 306
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:14:08,926 - batch_size: 64
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:14:08,926 - num_workers: 8
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:14:08,926 - do_validation_while_train: False
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:14:08,926 - validation_interval_step: 2000
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:14:08,926 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:14:08,926 - logdir: ./log
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:14:08,926 - log_interval_step: 100
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:14:08,926 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:14:08,926 - resume: False
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:14:08,926 - checkpoint_dir: None
[2025-03-13 13:14:08,926] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:14:08,926 - max_num_last_checkpoint: 1
[2025-03-13 13:14:08,926] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:14:08,926 - ------------------------

[2025-03-13 13:14:08,928] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:14:08,928 - read label file finished, total num: 4932
[2025-03-13 13:14:08,928] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:14:08,928 - world_size: 1
[2025-03-13 13:14:08,928] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:14:08,928 - total_batch_size: 64
[2025-03-13 13:14:08,928] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:14:08,928 - warmup_steps: 0
[2025-03-13 13:14:08,928] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:14:08,928 - steps_per_epoch: 77
[2025-03-13 13:14:08,928] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:14:08,928 - total_steps: 1925
[2025-03-13 13:14:08,928] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:14:08,928 - total_epoch: 25
[2025-03-13 13:14:08,928] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:14:08,928 - decay_steps: [770, 1232, 1694]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 96, in __init__
    self.optimizer = paddle.static.amp.decorate(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/function_overload.py", line 56, in __call__
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
TypeError: decorate() got an unexpected keyword argument 'use_fp16_guard'
[2025-03-13 13:16:17,187] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:16:17,187 - rank: 0
[2025-03-13 13:16:17,188] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:16:17,188 - --------args----------
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:16:17,188 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:16:17,188 - is_static: True
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:16:17,188 - backbone: FresResNet50
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:16:17,188 - classifier: LargeScaleClassifier
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:16:17,188 - embedding_size: 512
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:16:17,188 - model_parallel: True
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:16:17,188 - sample_ratio: 0.1
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:16:17,188 - loss: ArcFace
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:16:17,188 - dropout: 0.0
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:16:17,188 - fp16: True
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:16:17,188 - init_loss_scaling: 27648.0
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:16:17,188 - max_loss_scaling: 128.0
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:16:17,188 - incr_every_n_steps: 2000
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:16:17,188 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:16:17,188 - incr_ratio: 2.0
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:16:17,188 - decr_ratio: 0.5
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:16:17,188 - use_dynamic_loss_scaling: True
[2025-03-13 13:16:17,188] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:16:17,188 - custom_white_list: []
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:16:17,189 - custom_black_list: []
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:16:17,189 - lr: 0.01
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:16:17,189 - lr_decay: 0.1
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:16:17,189 - weight_decay: 0.0005
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:16:17,189 - momentum: 0.9
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:16:17,189 - train_unit: epoch
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:16:17,189 - warmup_num: 0
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:16:17,189 - train_num: 25
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:16:17,189 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:16:17,189 - use_synthetic_dataset: False
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:16:17,189 - dataset: custom_dataset
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:16:17,189 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:16:17,189 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:16:17,189 - is_bin: False
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:16:17,189 - num_classes: 306
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:16:17,189 - batch_size: 64
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:16:17,189 - num_workers: 8
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:16:17,189 - do_validation_while_train: False
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:16:17,189 - validation_interval_step: 2000
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:16:17,189 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:16:17,189 - logdir: ./log
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:16:17,189 - log_interval_step: 100
[2025-03-13 13:16:17,189] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:16:17,189 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:16:17,190] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:16:17,190 - resume: False
[2025-03-13 13:16:17,190] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:16:17,190 - checkpoint_dir: None
[2025-03-13 13:16:17,190] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:16:17,190 - max_num_last_checkpoint: 1
[2025-03-13 13:16:17,190] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:16:17,190 - ------------------------

[2025-03-13 13:16:17,191] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:16:17,191 - read label file finished, total num: 4932
[2025-03-13 13:16:17,191] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:16:17,191 - world_size: 1
[2025-03-13 13:16:17,192] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:16:17,192 - total_batch_size: 64
[2025-03-13 13:16:17,192] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:16:17,192 - warmup_steps: 0
[2025-03-13 13:16:17,192] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:16:17,192 - steps_per_epoch: 77
[2025-03-13 13:16:17,192] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:16:17,192 - total_steps: 1925
[2025-03-13 13:16:17,192] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:16:17,192 - total_epoch: 25
[2025-03-13 13:16:17,192] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:16:17,192 - decay_steps: [770, 1232, 1694]
I0313 13:16:18.443398 387259 program_interpreter.cc:212] New Executor is Running.
W0313 13:16:18.450660 387259 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.2, Runtime API Version: 11.8
W0313 13:16:18.451653 387259 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 13:18:23,715] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:18:23,715 - rank: 0
[2025-03-13 13:18:23,716] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:18:23,716 - --------args----------
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:18:23,716 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:18:23,716 - is_static: True
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:18:23,716 - backbone: FresResNet50
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:18:23,716 - classifier: LargeScaleClassifier
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:18:23,716 - embedding_size: 512
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:18:23,716 - model_parallel: True
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:18:23,716 - sample_ratio: 0.1
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:18:23,716 - loss: ArcFace
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:18:23,716 - dropout: 0.0
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:18:23,716 - fp16: True
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:18:23,716 - init_loss_scaling: 27648.0
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:18:23,716 - max_loss_scaling: 128.0
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:18:23,716 - incr_every_n_steps: 2000
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:18:23,716 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:18:23,716 - incr_ratio: 2.0
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:18:23,716 - decr_ratio: 0.5
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:18:23,716 - use_dynamic_loss_scaling: True
[2025-03-13 13:18:23,716] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:18:23,716 - custom_white_list: []
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:18:23,717 - custom_black_list: []
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:18:23,717 - lr: 0.01
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:18:23,717 - lr_decay: 0.1
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:18:23,717 - weight_decay: 0.0005
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:18:23,717 - momentum: 0.9
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:18:23,717 - train_unit: epoch
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:18:23,717 - warmup_num: 0
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:18:23,717 - train_num: 25
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:18:23,717 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:18:23,717 - use_synthetic_dataset: False
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:18:23,717 - dataset: custom_dataset
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:18:23,717 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:18:23,717 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:18:23,717 - is_bin: False
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:18:23,717 - num_classes: 306
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:18:23,717 - batch_size: 64
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:18:23,717 - num_workers: 8
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:18:23,717 - do_validation_while_train: False
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:18:23,717 - validation_interval_step: 2000
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:18:23,717 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:18:23,717 - logdir: ./log
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:18:23,717 - log_interval_step: 100
[2025-03-13 13:18:23,717] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:18:23,717 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:18:23,718] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:18:23,718 - resume: False
[2025-03-13 13:18:23,718] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:18:23,718 - checkpoint_dir: None
[2025-03-13 13:18:23,718] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:18:23,718 - max_num_last_checkpoint: 1
[2025-03-13 13:18:23,718] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:18:23,718 - ------------------------

[2025-03-13 13:18:23,719] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:18:23,719 - read label file finished, total num: 4932
[2025-03-13 13:18:23,719] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:18:23,719 - world_size: 1
[2025-03-13 13:18:23,719] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:18:23,719 - total_batch_size: 64
[2025-03-13 13:18:23,719] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:18:23,719 - warmup_steps: 0
[2025-03-13 13:18:23,719] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:18:23,719 - steps_per_epoch: 77
[2025-03-13 13:18:23,720] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:18:23,720 - total_steps: 1925
[2025-03-13 13:18:23,720] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:18:23,720 - total_epoch: 25
[2025-03-13 13:18:23,720] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:18:23,720 - decay_steps: [770, 1232, 1694]
I0313 13:18:24.919523 387829 program_interpreter.cc:212] New Executor is Running.
W0313 13:18:24.926805 387829 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.2, Runtime API Version: 11.8
W0313 13:18:24.927337 387829 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 13:18:54,003] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 13:18:54,003 - rank: 0
[2025-03-13 13:18:54,004] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 13:18:54,004 - --------args----------
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 13:18:54,004 - config_file: configs/my_custom_dataset.py
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 13:18:54,004 - is_static: True
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 13:18:54,004 - backbone: FresResNet50
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 13:18:54,004 - classifier: LargeScaleClassifier
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 13:18:54,004 - embedding_size: 512
[2025-03-13 13:18:54,004] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 13:18:54,004 - model_parallel: True
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 13:18:54,005 - sample_ratio: 0.1
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 13:18:54,005 - loss: ArcFace
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 13:18:54,005 - dropout: 0.0
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 13:18:54,005 - fp16: True
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 13:18:54,005 - init_loss_scaling: 27648.0
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 13:18:54,005 - max_loss_scaling: 128.0
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 13:18:54,005 - incr_every_n_steps: 2000
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 13:18:54,005 - decr_every_n_nan_or_inf: 1
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 13:18:54,005 - incr_ratio: 2.0
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 13:18:54,005 - decr_ratio: 0.5
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 13:18:54,005 - use_dynamic_loss_scaling: True
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 13:18:54,005 - custom_white_list: []
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 13:18:54,005 - custom_black_list: []
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 13:18:54,005 - lr: 0.01
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 13:18:54,005 - lr_decay: 0.1
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 13:18:54,005 - weight_decay: 0.0005
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 13:18:54,005 - momentum: 0.9
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 13:18:54,005 - train_unit: epoch
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 13:18:54,005 - warmup_num: 0
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 13:18:54,005 - train_num: 25
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 13:18:54,005 - decay_boundaries: [10, 16, 22]
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 13:18:54,005 - use_synthetic_dataset: False
[2025-03-13 13:18:54,005] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 13:18:54,005 - dataset: custom_dataset
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 13:18:54,006 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 13:18:54,006 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 13:18:54,006 - is_bin: False
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 13:18:54,006 - num_classes: 306
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 13:18:54,006 - batch_size: 64
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 13:18:54,006 - num_workers: 8
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 13:18:54,006 - do_validation_while_train: False
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 13:18:54,006 - validation_interval_step: 2000
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 13:18:54,006 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 13:18:54,006 - logdir: ./log
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 13:18:54,006 - log_interval_step: 100
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 13:18:54,006 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 13:18:54,006 - resume: False
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 13:18:54,006 - checkpoint_dir: None
[2025-03-13 13:18:54,006] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 13:18:54,006 - max_num_last_checkpoint: 1
[2025-03-13 13:18:54,006] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 13:18:54,006 - ------------------------

[2025-03-13 13:18:54,008] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 13:18:54,008 - read label file finished, total num: 4932
[2025-03-13 13:18:54,008] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 13:18:54,008 - world_size: 1
[2025-03-13 13:18:54,008] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 13:18:54,008 - total_batch_size: 64
[2025-03-13 13:18:54,008] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 13:18:54,008 - warmup_steps: 0
[2025-03-13 13:18:54,008] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 13:18:54,008 - steps_per_epoch: 77
[2025-03-13 13:18:54,008] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 13:18:54,008 - total_steps: 1925
[2025-03-13 13:18:54,008] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 13:18:54,008 - total_epoch: 25
[2025-03-13 13:18:54,008] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 13:18:54,008 - decay_steps: [770, 1232, 1694]
I0313 13:18:55.202754 388049 program_interpreter.cc:212] New Executor is Running.
W0313 13:18:55.209842 388049 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.2, Runtime API Version: 11.8
W0313 13:18:55.210366 388049 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 14:49:48,568] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 14:49:48,568 - rank: 0
[2025-03-13 14:49:48,568] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 14:49:48,568 - --------args----------
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 14:49:48,568 - config_file: configs/my_custom_dataset.py
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 14:49:48,568 - is_static: True
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 14:49:48,568 - backbone: FresResNet50
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 14:49:48,568 - classifier: LargeScaleClassifier
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 14:49:48,568 - embedding_size: 512
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 14:49:48,568 - model_parallel: True
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 14:49:48,568 - sample_ratio: 0.1
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 14:49:48,568 - loss: ArcFace
[2025-03-13 14:49:48,568] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 14:49:48,568 - dropout: 0.0
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 14:49:48,569 - fp16: True
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 14:49:48,569 - init_loss_scaling: 27648.0
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 14:49:48,569 - max_loss_scaling: 128.0
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 14:49:48,569 - incr_every_n_steps: 2000
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 14:49:48,569 - decr_every_n_nan_or_inf: 1
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 14:49:48,569 - incr_ratio: 2.0
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 14:49:48,569 - decr_ratio: 0.5
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 14:49:48,569 - use_dynamic_loss_scaling: True
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 14:49:48,569 - custom_white_list: []
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 14:49:48,569 - custom_black_list: []
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 14:49:48,569 - lr: 0.01
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 14:49:48,569 - lr_decay: 0.1
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 14:49:48,569 - weight_decay: 0.0005
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 14:49:48,569 - momentum: 0.9
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 14:49:48,569 - train_unit: epoch
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 14:49:48,569 - warmup_num: 0
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 14:49:48,569 - train_num: 25
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 14:49:48,569 - decay_boundaries: [10, 16, 22]
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 14:49:48,569 - use_synthetic_dataset: False
[2025-03-13 14:49:48,569] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 14:49:48,569 - dataset: custom_dataset
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 14:49:48,570 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 14:49:48,570 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 14:49:48,570 - is_bin: False
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 14:49:48,570 - num_classes: 306
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 14:49:48,570 - batch_size: 64
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 14:49:48,570 - num_workers: 8
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 14:49:48,570 - do_validation_while_train: False
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 14:49:48,570 - validation_interval_step: 2000
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 14:49:48,570 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 14:49:48,570 - logdir: ./log
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 14:49:48,570 - log_interval_step: 100
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 14:49:48,570 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 14:49:48,570 - resume: False
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 14:49:48,570 - checkpoint_dir: None
[2025-03-13 14:49:48,570] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 14:49:48,570 - max_num_last_checkpoint: 1
[2025-03-13 14:49:48,570] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 14:49:48,570 - ------------------------

[2025-03-13 14:49:48,572] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 14:49:48,572 - read label file finished, total num: 4932
[2025-03-13 14:49:48,572] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 14:49:48,572 - world_size: 1
[2025-03-13 14:49:48,572] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 14:49:48,572 - total_batch_size: 64
[2025-03-13 14:49:48,572] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 14:49:48,572 - warmup_steps: 0
[2025-03-13 14:49:48,572] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 14:49:48,572 - steps_per_epoch: 77
[2025-03-13 14:49:48,572] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 14:49:48,572 - total_steps: 1925
[2025-03-13 14:49:48,572] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 14:49:48,572 - total_epoch: 25
[2025-03-13 14:49:48,572] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 14:49:48,572 - decay_steps: [770, 1232, 1694]
I0313 14:49:49.776952 411033 program_interpreter.cc:212] New Executor is Running.
W0313 14:49:49.784183 411033 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 14:49:49.784795 411033 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 15:46:02,830] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 15:46:02,830 - rank: 0
[2025-03-13 15:46:02,830] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 15:46:02,830 - --------args----------
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 15:46:02,830 - config_file: configs/my_custom_dataset.py
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 15:46:02,830 - is_static: True
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 15:46:02,830 - backbone: FresResNet50
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 15:46:02,830 - classifier: LargeScaleClassifier
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 15:46:02,830 - embedding_size: 512
[2025-03-13 15:46:02,830] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 15:46:02,830 - model_parallel: True
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 15:46:02,831 - sample_ratio: 0.1
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 15:46:02,831 - loss: ArcFace
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 15:46:02,831 - dropout: 0.0
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 15:46:02,831 - fp16: True
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 15:46:02,831 - init_loss_scaling: 27648.0
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 15:46:02,831 - max_loss_scaling: 128.0
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 15:46:02,831 - incr_every_n_steps: 2000
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 15:46:02,831 - decr_every_n_nan_or_inf: 1
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 15:46:02,831 - incr_ratio: 2.0
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 15:46:02,831 - decr_ratio: 0.5
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 15:46:02,831 - use_dynamic_loss_scaling: True
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 15:46:02,831 - custom_white_list: []
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 15:46:02,831 - custom_black_list: []
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 15:46:02,831 - lr: 0.01
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 15:46:02,831 - lr_decay: 0.1
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 15:46:02,831 - weight_decay: 0.0005
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 15:46:02,831 - momentum: 0.9
[2025-03-13 15:46:02,831] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 15:46:02,831 - train_unit: epoch
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 15:46:02,832 - warmup_num: 0
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 15:46:02,832 - train_num: 25
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 15:46:02,832 - decay_boundaries: [10, 16, 22]
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 15:46:02,832 - use_synthetic_dataset: False
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 15:46:02,832 - dataset: custom_dataset
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 15:46:02,832 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 15:46:02,832 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 15:46:02,832 - is_bin: False
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 15:46:02,832 - num_classes: 306
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 15:46:02,832 - batch_size: 64
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 15:46:02,832 - num_workers: 8
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 15:46:02,832 - do_validation_while_train: False
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 15:46:02,832 - validation_interval_step: 2000
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 15:46:02,832 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 15:46:02,832 - logdir: ./log
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 15:46:02,832 - log_interval_step: 100
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 15:46:02,832 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 15:46:02,832 - resume: False
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 15:46:02,832 - checkpoint_dir: None
[2025-03-13 15:46:02,832] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 15:46:02,832 - max_num_last_checkpoint: 1
[2025-03-13 15:46:02,833] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 15:46:02,833 - ------------------------

[2025-03-13 15:46:02,834] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 15:46:02,834 - read label file finished, total num: 4932
[2025-03-13 15:46:02,835] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 15:46:02,835 - world_size: 1
[2025-03-13 15:46:02,835] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 15:46:02,835 - total_batch_size: 64
[2025-03-13 15:46:02,835] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 15:46:02,835 - warmup_steps: 0
[2025-03-13 15:46:02,835] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 15:46:02,835 - steps_per_epoch: 77
[2025-03-13 15:46:02,835] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 15:46:02,835 - total_steps: 1925
[2025-03-13 15:46:02,835] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 15:46:02,835 - total_epoch: 25
[2025-03-13 15:46:02,835] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 15:46:02,835 - decay_steps: [770, 1232, 1694]
I0313 15:46:04.043557 421688 program_interpreter.cc:212] New Executor is Running.
W0313 15:46:04.050915 421688 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 15:46:04.051503 421688 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 15:46:29,338] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 15:46:29,338 - rank: 0
[2025-03-13 15:46:29,338] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 15:46:29,338 - --------args----------
[2025-03-13 15:46:29,338] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 15:46:29,338 - config_file: configs/my_custom_dataset.py
[2025-03-13 15:46:29,338] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 15:46:29,338 - is_static: True
[2025-03-13 15:46:29,338] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 15:46:29,338 - backbone: FresResNet50
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 15:46:29,339 - classifier: LargeScaleClassifier
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 15:46:29,339 - embedding_size: 512
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 15:46:29,339 - model_parallel: True
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 15:46:29,339 - sample_ratio: 0.1
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 15:46:29,339 - loss: ArcFace
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 15:46:29,339 - dropout: 0.0
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 15:46:29,339 - fp16: True
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 15:46:29,339 - init_loss_scaling: 27648.0
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 15:46:29,339 - max_loss_scaling: 128.0
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 15:46:29,339 - incr_every_n_steps: 2000
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 15:46:29,339 - decr_every_n_nan_or_inf: 1
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 15:46:29,339 - incr_ratio: 2.0
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 15:46:29,339 - decr_ratio: 0.5
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 15:46:29,339 - use_dynamic_loss_scaling: True
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 15:46:29,339 - custom_white_list: []
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 15:46:29,339 - custom_black_list: []
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 15:46:29,339 - lr: 0.01
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 15:46:29,339 - lr_decay: 0.1
[2025-03-13 15:46:29,339] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 15:46:29,339 - weight_decay: 0.0005
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 15:46:29,340 - momentum: 0.9
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 15:46:29,340 - train_unit: epoch
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 15:46:29,340 - warmup_num: 0
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 15:46:29,340 - train_num: 25
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 15:46:29,340 - decay_boundaries: [10, 16, 22]
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 15:46:29,340 - use_synthetic_dataset: False
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 15:46:29,340 - dataset: custom_dataset
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 15:46:29,340 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 15:46:29,340 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 15:46:29,340 - is_bin: False
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 15:46:29,340 - num_classes: 306
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 15:46:29,340 - batch_size: 64
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 15:46:29,340 - num_workers: 8
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 15:46:29,340 - do_validation_while_train: False
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 15:46:29,340 - validation_interval_step: 2000
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 15:46:29,340 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 15:46:29,340 - logdir: ./log
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 15:46:29,340 - log_interval_step: 100
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 15:46:29,340 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 15:46:29,340 - resume: False
[2025-03-13 15:46:29,340] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 15:46:29,340 - checkpoint_dir: None
[2025-03-13 15:46:29,341] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 15:46:29,341 - max_num_last_checkpoint: 1
[2025-03-13 15:46:29,341] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 15:46:29,341 - ------------------------

[2025-03-13 15:46:29,342] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 15:46:29,342 - read label file finished, total num: 4932
[2025-03-13 15:46:29,342] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 15:46:29,342 - world_size: 1
[2025-03-13 15:46:29,342] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 15:46:29,342 - total_batch_size: 64
[2025-03-13 15:46:29,342] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 15:46:29,342 - warmup_steps: 0
[2025-03-13 15:46:29,342] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 15:46:29,342 - steps_per_epoch: 77
[2025-03-13 15:46:29,342] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 15:46:29,342 - total_steps: 1925
[2025-03-13 15:46:29,343] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 15:46:29,343 - total_epoch: 25
[2025-03-13 15:46:29,343] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 15:46:29,343 - decay_steps: [770, 1232, 1694]
I0313 15:46:30.550704 422049 program_interpreter.cc:212] New Executor is Running.
W0313 15:46:30.558277 422049 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 15:46:30.558946 422049 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 15:54:33,278] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 15:54:33,278 - rank: 0
[2025-03-13 15:54:33,280] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 15:54:33,280 - --------args----------
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 15:54:33,280 - config_file: configs/my_custom_dataset.py
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 15:54:33,280 - is_static: True
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 15:54:33,280 - backbone: FresResNet50
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 15:54:33,280 - classifier: LargeScaleClassifier
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 15:54:33,280 - embedding_size: 512
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 15:54:33,280 - model_parallel: True
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 15:54:33,280 - sample_ratio: 0.1
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 15:54:33,280 - loss: ArcFace
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 15:54:33,280 - dropout: 0.0
[2025-03-13 15:54:33,280] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 15:54:33,280 - fp16: True
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 15:54:33,281 - init_loss_scaling: 27648.0
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 15:54:33,281 - max_loss_scaling: 128.0
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 15:54:33,281 - incr_every_n_steps: 2000
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 15:54:33,281 - decr_every_n_nan_or_inf: 1
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 15:54:33,281 - incr_ratio: 2.0
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 15:54:33,281 - decr_ratio: 0.5
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 15:54:33,281 - use_dynamic_loss_scaling: True
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 15:54:33,281 - custom_white_list: []
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 15:54:33,281 - custom_black_list: []
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 15:54:33,281 - lr: 0.01
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 15:54:33,281 - lr_decay: 0.1
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 15:54:33,281 - weight_decay: 0.0005
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 15:54:33,281 - momentum: 0.9
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 15:54:33,281 - train_unit: epoch
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 15:54:33,281 - warmup_num: 0
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 15:54:33,281 - train_num: 25
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 15:54:33,281 - decay_boundaries: [10, 16, 22]
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 15:54:33,281 - use_synthetic_dataset: False
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 15:54:33,281 - dataset: custom_dataset
[2025-03-13 15:54:33,281] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 15:54:33,281 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 15:54:33,282 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 15:54:33,282 - is_bin: False
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 15:54:33,282 - num_classes: 306
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 15:54:33,282 - batch_size: 64
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 15:54:33,282 - num_workers: 8
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 15:54:33,282 - do_validation_while_train: False
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 15:54:33,282 - validation_interval_step: 2000
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 15:54:33,282 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 15:54:33,282 - logdir: ./log
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 15:54:33,282 - log_interval_step: 100
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 15:54:33,282 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 15:54:33,282 - resume: False
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 15:54:33,282 - checkpoint_dir: None
[2025-03-13 15:54:33,282] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 15:54:33,282 - max_num_last_checkpoint: 1
[2025-03-13 15:54:33,282] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 15:54:33,282 - ------------------------

[2025-03-13 15:54:33,284] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 15:54:33,284 - read label file finished, total num: 4932
[2025-03-13 15:54:33,284] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 15:54:33,284 - world_size: 1
[2025-03-13 15:54:33,284] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 15:54:33,284 - total_batch_size: 64
[2025-03-13 15:54:33,284] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 15:54:33,284 - warmup_steps: 0
[2025-03-13 15:54:33,284] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 15:54:33,284 - steps_per_epoch: 77
[2025-03-13 15:54:33,284] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 15:54:33,284 - total_steps: 1925
[2025-03-13 15:54:33,284] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 15:54:33,284 - total_epoch: 25
[2025-03-13 15:54:33,285] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 15:54:33,285 - decay_steps: [770, 1232, 1694]
I0313 15:54:34.491192 424887 program_interpreter.cc:212] New Executor is Running.
W0313 15:54:34.498908 424887 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 15:54:34.499635 424887 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 15:56:01,016] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 15:56:01,016 - rank: 0
[2025-03-13 15:56:01,016] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 15:56:01,016 - --------args----------
[2025-03-13 15:56:01,016] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 15:56:01,016 - config_file: configs/my_custom_dataset.py
[2025-03-13 15:56:01,016] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 15:56:01,016 - is_static: True
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 15:56:01,017 - backbone: FresResNet50
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 15:56:01,017 - classifier: LargeScaleClassifier
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 15:56:01,017 - embedding_size: 512
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 15:56:01,017 - model_parallel: True
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 15:56:01,017 - sample_ratio: 0.1
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 15:56:01,017 - loss: ArcFace
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 15:56:01,017 - dropout: 0.0
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 15:56:01,017 - fp16: True
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 15:56:01,017 - init_loss_scaling: 27648.0
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 15:56:01,017 - max_loss_scaling: 128.0
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 15:56:01,017 - incr_every_n_steps: 2000
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 15:56:01,017 - decr_every_n_nan_or_inf: 1
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 15:56:01,017 - incr_ratio: 2.0
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 15:56:01,017 - decr_ratio: 0.5
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 15:56:01,017 - use_dynamic_loss_scaling: True
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 15:56:01,017 - custom_white_list: []
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 15:56:01,017 - custom_black_list: []
[2025-03-13 15:56:01,017] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 15:56:01,017 - lr: 0.01
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 15:56:01,018 - lr_decay: 0.1
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 15:56:01,018 - weight_decay: 0.0005
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 15:56:01,018 - momentum: 0.9
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 15:56:01,018 - train_unit: epoch
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 15:56:01,018 - warmup_num: 0
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 15:56:01,018 - train_num: 25
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 15:56:01,018 - decay_boundaries: [10, 16, 22]
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 15:56:01,018 - use_synthetic_dataset: False
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 15:56:01,018 - dataset: custom_dataset
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 15:56:01,018 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 15:56:01,018 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 15:56:01,018 - is_bin: False
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 15:56:01,018 - num_classes: 306
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 15:56:01,018 - batch_size: 64
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 15:56:01,018 - num_workers: 8
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 15:56:01,018 - do_validation_while_train: False
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 15:56:01,018 - validation_interval_step: 2000
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 15:56:01,018 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 15:56:01,018] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 15:56:01,018 - logdir: ./log
[2025-03-13 15:56:01,019] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 15:56:01,019 - log_interval_step: 100
[2025-03-13 15:56:01,019] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 15:56:01,019 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 15:56:01,019] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 15:56:01,019 - resume: False
[2025-03-13 15:56:01,019] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 15:56:01,019 - checkpoint_dir: None
[2025-03-13 15:56:01,019] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 15:56:01,019 - max_num_last_checkpoint: 1
[2025-03-13 15:56:01,019] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 15:56:01,019 - ------------------------

[2025-03-13 15:56:01,021] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 15:56:01,021 - read label file finished, total num: 4932
[2025-03-13 15:56:01,021] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 15:56:01,021 - world_size: 1
[2025-03-13 15:56:01,021] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 15:56:01,021 - total_batch_size: 64
[2025-03-13 15:56:01,021] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 15:56:01,021 - warmup_steps: 0
[2025-03-13 15:56:01,021] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 15:56:01,021 - steps_per_epoch: 77
[2025-03-13 15:56:01,021] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 15:56:01,021 - total_steps: 1925
[2025-03-13 15:56:01,021] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 15:56:01,021 - total_epoch: 25
[2025-03-13 15:56:01,021] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 15:56:01,021 - decay_steps: [770, 1232, 1694]
I0313 15:56:02.254144 425468 program_interpreter.cc:212] New Executor is Running.
W0313 15:56:02.261710 425468 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 15:56:02.262362 425468 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 16:06:00,760] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:06:00,760 - rank: 0
[2025-03-13 16:06:00,760] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:06:00,760 - --------args----------
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:06:00,760 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:06:00,760 - is_static: True
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:06:00,760 - backbone: FresResNet50
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:06:00,760 - classifier: LargeScaleClassifier
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:06:00,760 - embedding_size: 512
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:06:00,760 - model_parallel: True
[2025-03-13 16:06:00,760] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:06:00,760 - sample_ratio: 0.1
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:06:00,761 - loss: ArcFace
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:06:00,761 - dropout: 0.0
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:06:00,761 - fp16: True
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:06:00,761 - init_loss_scaling: 27648.0
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:06:00,761 - max_loss_scaling: 128.0
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:06:00,761 - incr_every_n_steps: 2000
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:06:00,761 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:06:00,761 - incr_ratio: 2.0
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:06:00,761 - decr_ratio: 0.5
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:06:00,761 - use_dynamic_loss_scaling: True
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:06:00,761 - custom_white_list: []
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:06:00,761 - custom_black_list: []
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:06:00,761 - lr: 0.01
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:06:00,761 - lr_decay: 0.1
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:06:00,761 - weight_decay: 0.0005
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:06:00,761 - momentum: 0.9
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:06:00,761 - train_unit: epoch
[2025-03-13 16:06:00,761] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:06:00,761 - warmup_num: 0
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:06:00,762 - train_num: 25
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:06:00,762 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:06:00,762 - use_synthetic_dataset: False
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:06:00,762 - dataset: custom_dataset
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:06:00,762 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:06:00,762 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:06:00,762 - is_bin: False
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 16:06:00,762 - num_classes: 306
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 16:06:00,762 - batch_size: 64
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:06:00,762 - num_workers: 8
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:06:00,762 - do_validation_while_train: False
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:06:00,762 - validation_interval_step: 2000
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:06:00,762 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:06:00,762 - logdir: ./log
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:06:00,762 - log_interval_step: 100
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:06:00,762 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:06:00,762 - resume: False
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:06:00,762 - checkpoint_dir: None
[2025-03-13 16:06:00,762] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:06:00,762 - max_num_last_checkpoint: 1
[2025-03-13 16:06:00,762] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:06:00,762 - ------------------------

[2025-03-13 16:06:00,765] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:06:00,765 - read label file finished, total num: 4932
[2025-03-13 16:06:00,765] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:06:00,765 - world_size: 1
[2025-03-13 16:06:00,765] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 16:06:00,765 - total_batch_size: 64
[2025-03-13 16:06:00,765] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:06:00,765 - warmup_steps: 0
[2025-03-13 16:06:00,765] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 16:06:00,765 - steps_per_epoch: 77
[2025-03-13 16:06:00,765] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 16:06:00,765 - total_steps: 1925
[2025-03-13 16:06:00,765] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:06:00,765 - total_epoch: 25
[2025-03-13 16:06:00,765] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 16:06:00,765 - decay_steps: [770, 1232, 1694]
I0313 16:06:01.984498 427704 program_interpreter.cc:212] New Executor is Running.
W0313 16:06:01.992290 427704 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:06:01.992934 427704 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 16:07:44,696] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:07:44,696 - rank: 0
[2025-03-13 16:07:44,696] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:07:44,696 - --------args----------
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:07:44,696 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:07:44,696 - is_static: True
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:07:44,696 - backbone: FresResNet50
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:07:44,696 - classifier: LargeScaleClassifier
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:07:44,696 - embedding_size: 512
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:07:44,696 - model_parallel: True
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:07:44,696 - sample_ratio: 0.1
[2025-03-13 16:07:44,696] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:07:44,696 - loss: ArcFace
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:07:44,697 - dropout: 0.0
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:07:44,697 - fp16: True
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:07:44,697 - init_loss_scaling: 27648.0
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:07:44,697 - max_loss_scaling: 128.0
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:07:44,697 - incr_every_n_steps: 2000
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:07:44,697 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:07:44,697 - incr_ratio: 2.0
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:07:44,697 - decr_ratio: 0.5
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:07:44,697 - use_dynamic_loss_scaling: True
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:07:44,697 - custom_white_list: []
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:07:44,697 - custom_black_list: []
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:07:44,697 - lr: 0.01
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:07:44,697 - lr_decay: 0.1
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:07:44,697 - weight_decay: 0.0005
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:07:44,697 - momentum: 0.9
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:07:44,697 - train_unit: epoch
[2025-03-13 16:07:44,697] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:07:44,697 - warmup_num: 0
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:07:44,698 - train_num: 25
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:07:44,698 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:07:44,698 - use_synthetic_dataset: False
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:07:44,698 - dataset: custom_dataset
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:07:44,698 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:07:44,698 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:07:44,698 - is_bin: False
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 16:07:44,698 - num_classes: 306
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 16:07:44,698 - batch_size: 64
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:07:44,698 - num_workers: 8
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:07:44,698 - do_validation_while_train: False
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:07:44,698 - validation_interval_step: 2000
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:07:44,698 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:07:44,698 - logdir: ./log
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:07:44,698 - log_interval_step: 100
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:07:44,698 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:07:44,698 - resume: False
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:07:44,698 - checkpoint_dir: None
[2025-03-13 16:07:44,698] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:07:44,698 - max_num_last_checkpoint: 1
[2025-03-13 16:07:44,699] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:07:44,699 - ------------------------

[2025-03-13 16:07:44,701] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:07:44,701 - read label file finished, total num: 4932
[2025-03-13 16:07:44,701] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:07:44,701 - world_size: 1
[2025-03-13 16:07:44,701] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 16:07:44,701 - total_batch_size: 64
[2025-03-13 16:07:44,701] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:07:44,701 - warmup_steps: 0
[2025-03-13 16:07:44,701] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 16:07:44,701 - steps_per_epoch: 77
[2025-03-13 16:07:44,701] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 16:07:44,701 - total_steps: 1925
[2025-03-13 16:07:44,701] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:07:44,701 - total_epoch: 25
[2025-03-13 16:07:44,701] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 16:07:44,701 - decay_steps: [770, 1232, 1694]
I0313 16:07:45.969242 428309 program_interpreter.cc:212] New Executor is Running.
W0313 16:07:45.977134 428309 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:07:45.977824 428309 dynamic_loader.cc:314] The third-party dynamic library (libcudnn.so) that Paddle depends on is not configured correctly. (error code is /usr/local/cuda/lib64/libcudnn.so: cannot open shared object file: No such file or directory)
  Suggestions:
  1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
  2. Configure third-party dynamic library environment variables as follows:
  - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
  - Windows: set PATH by `set PATH=XXX;
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 166, in train
    exe.run(startup_program)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 64, in __init__
      input_blob = paddle.static.nn.conv2d(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 1028, in conv2d
      filter_param = helper.create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper_base.py", line 444, in create_parameter
      self.startup_program.global_block().create_parameter(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4381, in create_parameter
      initializer(param, self)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/initializer.py", line 40, in __call__
      return self.forward(param, block)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/nn/initializer/normal.py", line 97, in forward
      op = block.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: Cannot load cudnn shared library. Cannot invoke method cudnnGetVersion.
      [Hint: cudnn_dso_handle should not be null.] (at /paddle/paddle/phi/backends/dynload/cudnn.cc:64)
      [operator < gaussian_random > error]
[2025-03-13 16:12:31,713] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:12:31,713 - rank: 0
[2025-03-13 16:12:31,713] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:12:31,713 - --------args----------
[2025-03-13 16:12:31,713] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:12:31,713 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:12:31,714 - is_static: True
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:12:31,714 - backbone: FresResNet50
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:12:31,714 - classifier: LargeScaleClassifier
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:12:31,714 - embedding_size: 512
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:12:31,714 - model_parallel: True
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:12:31,714 - sample_ratio: 0.1
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:12:31,714 - loss: ArcFace
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:12:31,714 - dropout: 0.0
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:12:31,714 - fp16: True
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:12:31,714 - init_loss_scaling: 27648.0
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:12:31,714 - max_loss_scaling: 128.0
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:12:31,714 - incr_every_n_steps: 2000
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:12:31,714 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:12:31,714 - incr_ratio: 2.0
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:12:31,714 - decr_ratio: 0.5
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:12:31,714 - use_dynamic_loss_scaling: True
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:12:31,714 - custom_white_list: []
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:12:31,714 - custom_black_list: []
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:12:31,714 - lr: 0.01
[2025-03-13 16:12:31,714] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:12:31,714 - lr_decay: 0.1
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:12:31,715 - weight_decay: 0.0005
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:12:31,715 - momentum: 0.9
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:12:31,715 - train_unit: epoch
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:12:31,715 - warmup_num: 0
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:12:31,715 - train_num: 25
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:12:31,715 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:12:31,715 - use_synthetic_dataset: False
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:12:31,715 - dataset: custom_dataset
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:12:31,715 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:12:31,715 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:12:31,715 - is_bin: False
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 16:12:31,715 - num_classes: 306
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 16:12:31,715 - batch_size: 64
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:12:31,715 - num_workers: 8
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:12:31,715 - do_validation_while_train: False
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:12:31,715 - validation_interval_step: 2000
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:12:31,715 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:12:31,715 - logdir: ./log
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:12:31,715 - log_interval_step: 100
[2025-03-13 16:12:31,715] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:12:31,715 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:12:31,716] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:12:31,716 - resume: False
[2025-03-13 16:12:31,716] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:12:31,716 - checkpoint_dir: None
[2025-03-13 16:12:31,716] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:12:31,716 - max_num_last_checkpoint: 1
[2025-03-13 16:12:31,716] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:12:31,716 - ------------------------

[2025-03-13 16:12:31,718] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:12:31,718 - read label file finished, total num: 4932
[2025-03-13 16:12:31,718] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:12:31,718 - world_size: 1
[2025-03-13 16:12:31,718] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 16:12:31,718 - total_batch_size: 64
[2025-03-13 16:12:31,718] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:12:31,718 - warmup_steps: 0
[2025-03-13 16:12:31,718] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 16:12:31,718 - steps_per_epoch: 77
[2025-03-13 16:12:31,718] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 16:12:31,718 - total_steps: 1925
[2025-03-13 16:12:31,718] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:12:31,718 - total_epoch: 25
[2025-03-13 16:12:31,718] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 16:12:31,718 - decay_steps: [770, 1232, 1694]
I0313 16:12:32.943315 429498 program_interpreter.cc:212] New Executor is Running.
W0313 16:12:32.950954 429498 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:12:32.953994 429498 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    self.run()
  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
    self._target(*self._args, **self._kwargs)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    batch = self._get_data()
            ^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
    batch.reraise()
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
    raise self.exc_type(msg)
ValueError: DataLoader worker(1) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 62, in __getitem__
    img_path, label = line.strip().split(self.delimiter)
    ^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
    for step, data in enumerate(train_loader):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
    data = self._reader.read_next()
           ^^^^^^^^^^^^^^^^^^^^^^^^
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)

[2025-03-13 16:31:55,501] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:31:55,501 - rank: 0
[2025-03-13 16:31:55,501] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:31:55,501 - --------args----------
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:31:55,501 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:31:55,501 - is_static: True
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:31:55,501 - backbone: FresResNet50
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:31:55,501 - classifier: LargeScaleClassifier
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:31:55,501 - embedding_size: 512
[2025-03-13 16:31:55,501] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:31:55,501 - model_parallel: True
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:31:55,502 - sample_ratio: 0.1
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:31:55,502 - loss: ArcFace
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:31:55,502 - dropout: 0.0
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:31:55,502 - fp16: True
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:31:55,502 - init_loss_scaling: 27648.0
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:31:55,502 - max_loss_scaling: 128.0
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:31:55,502 - incr_every_n_steps: 2000
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:31:55,502 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:31:55,502 - incr_ratio: 2.0
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:31:55,502 - decr_ratio: 0.5
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:31:55,502 - use_dynamic_loss_scaling: True
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:31:55,502 - custom_white_list: []
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:31:55,502 - custom_black_list: []
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:31:55,502 - lr: 0.01
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:31:55,502 - lr_decay: 0.1
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:31:55,502 - weight_decay: 0.0005
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:31:55,502 - momentum: 0.9
[2025-03-13 16:31:55,502] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:31:55,502 - train_unit: epoch
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:31:55,503 - warmup_num: 0
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:31:55,503 - train_num: 25
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:31:55,503 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:31:55,503 - use_synthetic_dataset: False
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:31:55,503 - dataset: custom_dataset
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:31:55,503 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:31:55,503 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:31:55,503 - is_bin: False
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - num_classes: 306
Training: 2025-03-13 16:31:55,503 - num_classes: 306
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - batch_size: 64
Training: 2025-03-13 16:31:55,503 - batch_size: 64
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:31:55,503 - num_workers: 8
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:31:55,503 - do_validation_while_train: False
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:31:55,503 - validation_interval_step: 2000
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:31:55,503 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:31:55,503 - logdir: ./log
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:31:55,503 - log_interval_step: 100
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:31:55,503 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:31:55,503 - resume: False
[2025-03-13 16:31:55,503] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:31:55,503 - checkpoint_dir: None
[2025-03-13 16:31:55,504] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:31:55,504 - max_num_last_checkpoint: 1
[2025-03-13 16:31:55,504] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:31:55,504 - ------------------------

[2025-03-13 16:31:55,505] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:31:55,505 - read label file finished, total num: 4932
[2025-03-13 16:31:55,505] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:31:55,505 - world_size: 1
[2025-03-13 16:31:55,505] [    INFO] train.py:81 - total_batch_size: 64
Training: 2025-03-13 16:31:55,505 - total_batch_size: 64
[2025-03-13 16:31:55,505] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:31:55,505 - warmup_steps: 0
[2025-03-13 16:31:55,506] [    INFO] train.py:83 - steps_per_epoch: 77
Training: 2025-03-13 16:31:55,506 - steps_per_epoch: 77
[2025-03-13 16:31:55,506] [    INFO] train.py:84 - total_steps: 1925
Training: 2025-03-13 16:31:55,506 - total_steps: 1925
[2025-03-13 16:31:55,506] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:31:55,506 - total_epoch: 25
[2025-03-13 16:31:55,506] [    INFO] train.py:86 - decay_steps: [770, 1232, 1694]
Training: 2025-03-13 16:31:55,506 - decay_steps: [770, 1232, 1694]
I0313 16:31:56.700213 433907 program_interpreter.cc:212] New Executor is Running.
W0313 16:31:56.707355 433907 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:31:56.708552 433907 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
        self.run()train(args)

  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
        self._target(*self._args, **self._kwargs)for step, data in enumerate(train_loader):

  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
    batch = self._get_data()    
data = self._reader.read_next() 
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
^^^^^    ^batch.reraise()

SystemError  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)

    raise self.exc_type(msg)
ValueError: DataLoader worker(0) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 62, in __getitem__
    img_path, label = line.strip().split(self.delimiter)
    ^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

[2025-03-13 16:38:47,697] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:38:47,697 - rank: 0
[2025-03-13 16:38:47,698] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:38:47,698 - --------args----------
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:38:47,698 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:38:47,698 - is_static: True
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:38:47,698 - backbone: FresResNet50
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:38:47,698 - classifier: LargeScaleClassifier
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:38:47,698 - embedding_size: 512
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:38:47,698 - model_parallel: True
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:38:47,698 - sample_ratio: 0.1
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:38:47,698 - loss: ArcFace
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:38:47,698 - dropout: 0.0
[2025-03-13 16:38:47,698] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:38:47,698 - fp16: True
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:38:47,699 - init_loss_scaling: 27648.0
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:38:47,699 - max_loss_scaling: 128.0
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:38:47,699 - incr_every_n_steps: 2000
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:38:47,699 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:38:47,699 - incr_ratio: 2.0
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:38:47,699 - decr_ratio: 0.5
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:38:47,699 - use_dynamic_loss_scaling: True
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:38:47,699 - custom_white_list: []
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:38:47,699 - custom_black_list: []
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:38:47,699 - lr: 0.01
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:38:47,699 - lr_decay: 0.1
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:38:47,699 - weight_decay: 0.0005
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:38:47,699 - momentum: 0.9
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:38:47,699 - train_unit: epoch
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:38:47,699 - warmup_num: 0
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:38:47,699 - train_num: 25
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:38:47,699 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:38:47,699 - use_synthetic_dataset: False
[2025-03-13 16:38:47,699] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:38:47,699 - dataset: custom_dataset
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:38:47,700 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:38:47,700 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:38:47,700 - is_bin: False
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - num_classes: 307
Training: 2025-03-13 16:38:47,700 - num_classes: 307
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-13 16:38:47,700 - batch_size: 32
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:38:47,700 - num_workers: 8
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:38:47,700 - do_validation_while_train: False
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:38:47,700 - validation_interval_step: 2000
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:38:47,700 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:38:47,700 - logdir: ./log
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:38:47,700 - log_interval_step: 100
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:38:47,700 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:38:47,700 - resume: False
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:38:47,700 - checkpoint_dir: None
[2025-03-13 16:38:47,700] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:38:47,700 - max_num_last_checkpoint: 1
[2025-03-13 16:38:47,700] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:38:47,700 - ------------------------

[2025-03-13 16:38:47,703] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:38:47,703 - read label file finished, total num: 4932
[2025-03-13 16:38:47,703] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:38:47,703 - world_size: 1
[2025-03-13 16:38:47,704] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-13 16:38:47,704 - total_batch_size: 32
[2025-03-13 16:38:47,704] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:38:47,704 - warmup_steps: 0
[2025-03-13 16:38:47,704] [    INFO] train.py:83 - steps_per_epoch: 154
Training: 2025-03-13 16:38:47,704 - steps_per_epoch: 154
[2025-03-13 16:38:47,704] [    INFO] train.py:84 - total_steps: 3850
Training: 2025-03-13 16:38:47,704 - total_steps: 3850
[2025-03-13 16:38:47,704] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:38:47,704 - total_epoch: 25
[2025-03-13 16:38:47,704] [    INFO] train.py:86 - decay_steps: [1540, 2464, 3388]
Training: 2025-03-13 16:38:47,704 - decay_steps: [1540, 2464, 3388]
I0313 16:38:48.966836 435578 program_interpreter.cc:212] New Executor is Running.
W0313 16:38:48.974649 435578 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:38:48.976109 435578 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    self.run()
  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
        train(args)self._target(*self._args, **self._kwargs)

  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
        batch = self._get_data()for step, data in enumerate(train_loader):

    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
          ^^    ^data = self._reader.read_next()^
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^^
^^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
^^^^    ^batch.reraise()^
^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
^^^^^    ^raise self.exc_type(msg)^
^ValueError^: ^DataLoader worker(0) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 62, in __getitem__
    img_path, label = line.strip().split(self.delimiter)
    ^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)
^
^^^
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)

[2025-03-13 16:39:09,033] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 16:39:09,033 - rank: 0
[2025-03-13 16:39:09,033] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 16:39:09,033 - --------args----------
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 16:39:09,033 - config_file: configs/my_custom_dataset.py
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 16:39:09,033 - is_static: True
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 16:39:09,033 - backbone: FresResNet50
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 16:39:09,033 - classifier: LargeScaleClassifier
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 16:39:09,033 - embedding_size: 512
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 16:39:09,033 - model_parallel: True
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 16:39:09,033 - sample_ratio: 0.1
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 16:39:09,033 - loss: ArcFace
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 16:39:09,033 - dropout: 0.0
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 16:39:09,033 - fp16: True
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 16:39:09,033 - init_loss_scaling: 27648.0
[2025-03-13 16:39:09,033] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 16:39:09,033 - max_loss_scaling: 128.0
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 16:39:09,034 - incr_every_n_steps: 2000
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 16:39:09,034 - decr_every_n_nan_or_inf: 1
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 16:39:09,034 - incr_ratio: 2.0
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 16:39:09,034 - decr_ratio: 0.5
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 16:39:09,034 - use_dynamic_loss_scaling: True
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 16:39:09,034 - custom_white_list: []
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 16:39:09,034 - custom_black_list: []
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 16:39:09,034 - lr: 0.01
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 16:39:09,034 - lr_decay: 0.1
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 16:39:09,034 - weight_decay: 0.0005
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 16:39:09,034 - momentum: 0.9
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 16:39:09,034 - train_unit: epoch
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 16:39:09,034 - warmup_num: 0
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 16:39:09,034 - train_num: 25
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 16:39:09,034 - decay_boundaries: [10, 16, 22]
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 16:39:09,034 - use_synthetic_dataset: False
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 16:39:09,034 - dataset: custom_dataset
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 16:39:09,034 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 16:39:09,034] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 16:39:09,034 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 16:39:09,035 - is_bin: False
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - num_classes: 307
Training: 2025-03-13 16:39:09,035 - num_classes: 307
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-13 16:39:09,035 - batch_size: 32
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 16:39:09,035 - num_workers: 8
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 16:39:09,035 - do_validation_while_train: False
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 16:39:09,035 - validation_interval_step: 2000
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 16:39:09,035 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 16:39:09,035 - logdir: ./log
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 16:39:09,035 - log_interval_step: 100
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 16:39:09,035 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 16:39:09,035 - resume: False
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 16:39:09,035 - checkpoint_dir: None
[2025-03-13 16:39:09,035] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 16:39:09,035 - max_num_last_checkpoint: 1
[2025-03-13 16:39:09,035] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 16:39:09,035 - ------------------------

[2025-03-13 16:39:09,037] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 16:39:09,037 - read label file finished, total num: 4932
[2025-03-13 16:39:09,037] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 16:39:09,037 - world_size: 1
[2025-03-13 16:39:09,037] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-13 16:39:09,037 - total_batch_size: 32
[2025-03-13 16:39:09,037] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 16:39:09,037 - warmup_steps: 0
[2025-03-13 16:39:09,037] [    INFO] train.py:83 - steps_per_epoch: 154
Training: 2025-03-13 16:39:09,037 - steps_per_epoch: 154
[2025-03-13 16:39:09,037] [    INFO] train.py:84 - total_steps: 3850
Training: 2025-03-13 16:39:09,037 - total_steps: 3850
[2025-03-13 16:39:09,037] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 16:39:09,037 - total_epoch: 25
[2025-03-13 16:39:09,038] [    INFO] train.py:86 - decay_steps: [1540, 2464, 3388]
Training: 2025-03-13 16:39:09,038 - decay_steps: [1540, 2464, 3388]
I0313 16:39:10.242265 435968 program_interpreter.cc:212] New Executor is Running.
W0313 16:39:10.249883 435968 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 16:39:10.251199 435968 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    self.run()
  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
        train(args)self._target(*self._args, **self._kwargs)

  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
        batch = self._get_data()for step, data in enumerate(train_loader):

   File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
          data = self._reader.read_next() 
        ^ ^ ^ ^ ^ ^ ^ ^^^^^^^^^^^^^^^^^^
^^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
^^^^^^^    ^batch.reraise()^
^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
^^^
SystemError    : raise self.exc_type(msg)(Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)


ValueError: DataLoader worker(0) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 62, in __getitem__
    img_path, label = line.strip().split(self.delimiter)
    ^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

[2025-03-13 17:07:26,388] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 17:07:26,388 - rank: 0
[2025-03-13 17:07:26,388] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 17:07:26,388 - --------args----------
[2025-03-13 17:07:26,388] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 17:07:26,388 - config_file: configs/my_custom_dataset.py
[2025-03-13 17:07:26,388] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 17:07:26,388 - is_static: True
[2025-03-13 17:07:26,388] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 17:07:26,388 - backbone: FresResNet50
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 17:07:26,389 - classifier: LargeScaleClassifier
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 17:07:26,389 - embedding_size: 512
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 17:07:26,389 - model_parallel: True
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 17:07:26,389 - sample_ratio: 0.1
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 17:07:26,389 - loss: ArcFace
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 17:07:26,389 - dropout: 0.0
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 17:07:26,389 - fp16: True
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 17:07:26,389 - init_loss_scaling: 27648.0
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 17:07:26,389 - max_loss_scaling: 128.0
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 17:07:26,389 - incr_every_n_steps: 2000
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 17:07:26,389 - decr_every_n_nan_or_inf: 1
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 17:07:26,389 - incr_ratio: 2.0
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 17:07:26,389 - decr_ratio: 0.5
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 17:07:26,389 - use_dynamic_loss_scaling: True
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 17:07:26,389 - custom_white_list: []
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 17:07:26,389 - custom_black_list: []
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 17:07:26,389 - lr: 0.01
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 17:07:26,389 - lr_decay: 0.1
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 17:07:26,389 - weight_decay: 0.0005
[2025-03-13 17:07:26,389] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 17:07:26,389 - momentum: 0.9
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 17:07:26,390 - train_unit: epoch
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 17:07:26,390 - warmup_num: 0
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 17:07:26,390 - train_num: 25
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 17:07:26,390 - decay_boundaries: [10, 16, 22]
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 17:07:26,390 - use_synthetic_dataset: False
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 17:07:26,390 - dataset: custom_dataset
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 17:07:26,390 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 17:07:26,390 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 17:07:26,390 - is_bin: False
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - num_classes: 307
Training: 2025-03-13 17:07:26,390 - num_classes: 307
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-13 17:07:26,390 - batch_size: 32
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 17:07:26,390 - num_workers: 8
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 17:07:26,390 - do_validation_while_train: False
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 17:07:26,390 - validation_interval_step: 2000
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 17:07:26,390 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 17:07:26,390 - logdir: ./log
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 17:07:26,390 - log_interval_step: 100
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 17:07:26,390 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 17:07:26,390 - resume: False
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 17:07:26,390 - checkpoint_dir: None
[2025-03-13 17:07:26,390] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 17:07:26,390 - max_num_last_checkpoint: 1
[2025-03-13 17:07:26,391] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 17:07:26,391 - ------------------------

[2025-03-13 17:07:26,393] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 17:07:26,393 - read label file finished, total num: 4932
[2025-03-13 17:07:26,393] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 17:07:26,393 - world_size: 1
[2025-03-13 17:07:26,393] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-13 17:07:26,393 - total_batch_size: 32
[2025-03-13 17:07:26,393] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 17:07:26,393 - warmup_steps: 0
[2025-03-13 17:07:26,393] [    INFO] train.py:83 - steps_per_epoch: 154
Training: 2025-03-13 17:07:26,393 - steps_per_epoch: 154
[2025-03-13 17:07:26,394] [    INFO] train.py:84 - total_steps: 3850
Training: 2025-03-13 17:07:26,394 - total_steps: 3850
[2025-03-13 17:07:26,394] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 17:07:26,394 - total_epoch: 25
[2025-03-13 17:07:26,394] [    INFO] train.py:86 - decay_steps: [1540, 2464, 3388]
Training: 2025-03-13 17:07:26,394 - decay_steps: [1540, 2464, 3388]
I0313 17:07:27.603643 442827 program_interpreter.cc:212] New Executor is Running.
W0313 17:07:27.611215 442827 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 17:07:27.612525 442827 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Traceback (most recent call last):
Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
        self.run()for step, data in enumerate(train_loader):

  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
        self._target(*self._args, **self._kwargs)data = self._reader.read_next()

  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
            batch = self._get_data() 
    ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data

    batch.reraise()
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
    raise self.exc_type(msg)
ValueError: DataLoader worker(0) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 62, in __getitem__
    img_path, label = line.strip().split(self.delimiter)
    ^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

[2025-03-13 17:17:12,751] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 17:17:12,751 - rank: 0
[2025-03-13 17:17:12,752] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 17:17:12,752 - --------args----------
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 17:17:12,752 - config_file: configs/my_custom_dataset.py
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 17:17:12,752 - is_static: True
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 17:17:12,752 - backbone: FresResNet50
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 17:17:12,752 - classifier: LargeScaleClassifier
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 17:17:12,752 - embedding_size: 512
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 17:17:12,752 - model_parallel: True
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 17:17:12,752 - sample_ratio: 0.1
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 17:17:12,752 - loss: ArcFace
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 17:17:12,752 - dropout: 0.0
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 17:17:12,752 - fp16: True
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 17:17:12,752 - init_loss_scaling: 27648.0
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 17:17:12,752 - max_loss_scaling: 128.0
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 17:17:12,752 - incr_every_n_steps: 2000
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 17:17:12,752 - decr_every_n_nan_or_inf: 1
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 17:17:12,752 - incr_ratio: 2.0
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 17:17:12,752 - decr_ratio: 0.5
[2025-03-13 17:17:12,752] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 17:17:12,752 - use_dynamic_loss_scaling: True
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 17:17:12,753 - custom_white_list: []
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 17:17:12,753 - custom_black_list: []
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 17:17:12,753 - lr: 0.01
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 17:17:12,753 - lr_decay: 0.1
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 17:17:12,753 - weight_decay: 0.0005
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 17:17:12,753 - momentum: 0.9
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 17:17:12,753 - train_unit: epoch
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 17:17:12,753 - warmup_num: 0
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 17:17:12,753 - train_num: 25
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 17:17:12,753 - decay_boundaries: [10, 16, 22]
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 17:17:12,753 - use_synthetic_dataset: False
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 17:17:12,753 - dataset: custom_dataset
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 17:17:12,753 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 17:17:12,753 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 17:17:12,753 - is_bin: False
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - num_classes: 307
Training: 2025-03-13 17:17:12,753 - num_classes: 307
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-13 17:17:12,753 - batch_size: 32
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 17:17:12,753 - num_workers: 8
[2025-03-13 17:17:12,753] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 17:17:12,753 - do_validation_while_train: False
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 17:17:12,754 - validation_interval_step: 2000
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 17:17:12,754 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 17:17:12,754 - logdir: ./log
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 17:17:12,754 - log_interval_step: 100
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 17:17:12,754 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 17:17:12,754 - resume: False
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 17:17:12,754 - checkpoint_dir: None
[2025-03-13 17:17:12,754] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 17:17:12,754 - max_num_last_checkpoint: 1
[2025-03-13 17:17:12,754] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 17:17:12,754 - ------------------------

[2025-03-13 17:17:12,756] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 17:17:12,756 - read label file finished, total num: 4932
[2025-03-13 17:17:12,756] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 17:17:12,756 - world_size: 1
[2025-03-13 17:17:12,756] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-13 17:17:12,756 - total_batch_size: 32
[2025-03-13 17:17:12,756] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 17:17:12,756 - warmup_steps: 0
[2025-03-13 17:17:12,756] [    INFO] train.py:83 - steps_per_epoch: 154
Training: 2025-03-13 17:17:12,756 - steps_per_epoch: 154
[2025-03-13 17:17:12,756] [    INFO] train.py:84 - total_steps: 3850
Training: 2025-03-13 17:17:12,756 - total_steps: 3850
[2025-03-13 17:17:12,757] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 17:17:12,757 - total_epoch: 25
[2025-03-13 17:17:12,757] [    INFO] train.py:86 - decay_steps: [1540, 2464, 3388]
Training: 2025-03-13 17:17:12,757 - decay_steps: [1540, 2464, 3388]
I0313 17:17:13.962188 445383 program_interpreter.cc:212] New Executor is Running.
W0313 17:17:13.969480 445383 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 17:17:13.970767 445383 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    Traceback (most recent call last):
self.run()
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
    train(args)    
self._target(*self._args, **self._kwargs)  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train

  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
    for step, data in enumerate(train_loader):
      File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
batch = self._get_data()
            data = self._reader.read_next() 
      ^ ^ ^ ^ ^ ^ ^ ^ ^^^^^^^^^^^^^^^^
^^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
^^    ^batch.reraise()^
^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
^^^^^^^    ^raise self.exc_type(msg)^

TypeErrorSystemError: : DataLoader worker(1) caught TypeError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
                ~~~~~~~~~~~~^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 67, in __getitem__
    img = transform(img)
          ^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/datasets/common_dataset.py", line 35, in transform
    img = (img - 127.5) * 0.00784313725
           ~~~~^~~~~~~
TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'
(Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)


[2025-03-13 17:29:40,824] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-13 17:29:40,824 - rank: 0
[2025-03-13 17:29:40,824] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-13 17:29:40,824 - --------args----------
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-13 17:29:40,824 - config_file: configs/my_custom_dataset.py
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-13 17:29:40,824 - is_static: True
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-13 17:29:40,824 - backbone: FresResNet50
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-13 17:29:40,824 - classifier: LargeScaleClassifier
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-13 17:29:40,824 - embedding_size: 512
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-13 17:29:40,824 - model_parallel: True
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-13 17:29:40,824 - sample_ratio: 0.1
[2025-03-13 17:29:40,824] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-13 17:29:40,824 - loss: ArcFace
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-13 17:29:40,825 - dropout: 0.0
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-13 17:29:40,825 - fp16: True
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-13 17:29:40,825 - init_loss_scaling: 27648.0
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-13 17:29:40,825 - max_loss_scaling: 128.0
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-13 17:29:40,825 - incr_every_n_steps: 2000
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-13 17:29:40,825 - decr_every_n_nan_or_inf: 1
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-13 17:29:40,825 - incr_ratio: 2.0
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-13 17:29:40,825 - decr_ratio: 0.5
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-13 17:29:40,825 - use_dynamic_loss_scaling: True
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-13 17:29:40,825 - custom_white_list: []
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-13 17:29:40,825 - custom_black_list: []
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-13 17:29:40,825 - lr: 0.01
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-13 17:29:40,825 - lr_decay: 0.1
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-13 17:29:40,825 - weight_decay: 0.0005
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-13 17:29:40,825 - momentum: 0.9
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-13 17:29:40,825 - train_unit: epoch
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-13 17:29:40,825 - warmup_num: 0
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-13 17:29:40,825 - train_num: 25
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-13 17:29:40,825 - decay_boundaries: [10, 16, 22]
[2025-03-13 17:29:40,825] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-13 17:29:40,825 - use_synthetic_dataset: False
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-13 17:29:40,826 - dataset: custom_dataset
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-13 17:29:40,826 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-13 17:29:40,826 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-13 17:29:40,826 - is_bin: False
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - num_classes: 307
Training: 2025-03-13 17:29:40,826 - num_classes: 307
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-13 17:29:40,826 - batch_size: 32
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-13 17:29:40,826 - num_workers: 8
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-13 17:29:40,826 - do_validation_while_train: False
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-13 17:29:40,826 - validation_interval_step: 2000
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-13 17:29:40,826 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-13 17:29:40,826 - logdir: ./log
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-13 17:29:40,826 - log_interval_step: 100
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-13 17:29:40,826 - output: MS1M_v3_arcface_static_0.1
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-13 17:29:40,826 - resume: False
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-13 17:29:40,826 - checkpoint_dir: None
[2025-03-13 17:29:40,826] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-13 17:29:40,826 - max_num_last_checkpoint: 1
[2025-03-13 17:29:40,826] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-13 17:29:40,826 - ------------------------

[2025-03-13 17:29:40,828] [    INFO] common_dataset.py:55 - read label file finished, total num: 4932
Training: 2025-03-13 17:29:40,828 - read label file finished, total num: 4932
[2025-03-13 17:29:40,829] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-13 17:29:40,829 - world_size: 1
[2025-03-13 17:29:40,829] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-13 17:29:40,829 - total_batch_size: 32
[2025-03-13 17:29:40,829] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-13 17:29:40,829 - warmup_steps: 0
[2025-03-13 17:29:40,829] [    INFO] train.py:83 - steps_per_epoch: 154
Training: 2025-03-13 17:29:40,829 - steps_per_epoch: 154
[2025-03-13 17:29:40,829] [    INFO] train.py:84 - total_steps: 3850
Training: 2025-03-13 17:29:40,829 - total_steps: 3850
[2025-03-13 17:29:40,829] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-13 17:29:40,829 - total_epoch: 25
[2025-03-13 17:29:40,829] [    INFO] train.py:86 - decay_steps: [1540, 2464, 3388]
Training: 2025-03-13 17:29:40,829 - decay_steps: [1540, 2464, 3388]
I0313 17:29:42.028765 449457 program_interpreter.cc:212] New Executor is Running.
W0313 17:29:42.036381 449457 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0313 17:29:42.037717 449457 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Premature end of JPEG file
Premature end of JPEG file
Premature end of JPEG file
Exception in thread Thread-2 (_thread_loop):
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    self.run()
  File "/usr/local/lib/python3.12/threading.py", line 1010, in run
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    self._target(*self._args, **self._kwargs)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 603, in _thread_loop
        train(args)batch = self._get_data()

  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 197, in train
                for step, data in enumerate(train_loader):^
^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 845, in __next__
^^^^^^^^^^^    ^data = self._reader.read_next()^
^ 
      File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/dataloader_iter.py", line 752, in _get_data
         batch.reraise() 
^  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 187, in reraise
^^^^^    ^raise self.exc_type(msg)^
^ValueError^: ^DataLoader worker(4) caught ValueError with message:
Traceback (most recent call last):
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/worker.py", line 372, in _worker_loop
    batch = fetcher.fetch(indices)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/fetcher.py", line 85, in fetch
    data = self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/collate.py", line 75, in default_collate_fn
    return [default_collate_fn(fields) for fields in zip(*batch)]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/io/dataloader/collate.py", line 56, in default_collate_fn
    batch = np.stack(batch, axis=0)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/numpy/_core/shape_base.py", line 460, in stack
    raise ValueError('all input arrays must have the same shape')
ValueError: all input arrays must have the same shape
^
^^^^^^^^^^^^
SystemError: (Fatal) Blocking queue is killed because the data reader raises an exception.
  [Hint: Expected killed_ != true, but received killed_:1 == true:1.] (at /paddle/paddle/fluid/operators/reader/blocking_queue.h:175)

[2025-03-14 10:26:52,085] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 10:26:52,085 - rank: 0
[2025-03-14 10:26:52,085] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 10:26:52,085 - --------args----------
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 10:26:52,085 - config_file: configs/my_custom_dataset.py
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 10:26:52,085 - is_static: True
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 10:26:52,085 - backbone: FresResNet50
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 10:26:52,085 - classifier: LargeScaleClassifier
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 10:26:52,085 - embedding_size: 512
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 10:26:52,085 - model_parallel: True
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 10:26:52,085 - sample_ratio: 0.1
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 10:26:52,085 - loss: ArcFace
[2025-03-14 10:26:52,085] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 10:26:52,085 - dropout: 0.0
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 10:26:52,086 - fp16: True
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 10:26:52,086 - init_loss_scaling: 27648.0
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 10:26:52,086 - max_loss_scaling: 128.0
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 10:26:52,086 - incr_every_n_steps: 2000
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 10:26:52,086 - decr_every_n_nan_or_inf: 1
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 10:26:52,086 - incr_ratio: 2.0
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 10:26:52,086 - decr_ratio: 0.5
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 10:26:52,086 - use_dynamic_loss_scaling: True
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 10:26:52,086 - custom_white_list: []
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 10:26:52,086 - custom_black_list: []
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 10:26:52,086 - lr: 0.01
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 10:26:52,086 - lr_decay: 0.1
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 10:26:52,086 - weight_decay: 0.0005
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 10:26:52,086 - momentum: 0.9
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 10:26:52,086 - train_unit: epoch
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 10:26:52,086 - warmup_num: 0
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 10:26:52,086 - train_num: 25
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 10:26:52,086 - decay_boundaries: [10, 16, 22]
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 10:26:52,086 - use_synthetic_dataset: False
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 10:26:52,086 - dataset: custom_dataset
[2025-03-14 10:26:52,086] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 10:26:52,086 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 10:26:52,087 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 10:26:52,087 - is_bin: False
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 10:26:52,087 - num_classes: 312
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 10:26:52,087 - batch_size: 32
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 10:26:52,087 - num_workers: 8
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 10:26:52,087 - do_validation_while_train: False
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 10:26:52,087 - validation_interval_step: 2000
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 10:26:52,087 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 10:26:52,087 - logdir: ./log
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 10:26:52,087 - log_interval_step: 100
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 10:26:52,087 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 10:26:52,087 - resume: False
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 10:26:52,087 - checkpoint_dir: None
[2025-03-14 10:26:52,087] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 10:26:52,087 - max_num_last_checkpoint: 1
[2025-03-14 10:26:52,087] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 10:26:52,087 - ------------------------

[2025-03-14 10:26:52,091] [    INFO] common_dataset.py:55 - read label file finished, total num: 6987
Training: 2025-03-14 10:26:52,091 - read label file finished, total num: 6987
[2025-03-14 10:26:52,091] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 10:26:52,091 - world_size: 1
[2025-03-14 10:26:52,091] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 10:26:52,091 - total_batch_size: 32
[2025-03-14 10:26:52,091] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 10:26:52,091 - warmup_steps: 0
[2025-03-14 10:26:52,092] [    INFO] train.py:83 - steps_per_epoch: 218
Training: 2025-03-14 10:26:52,092 - steps_per_epoch: 218
[2025-03-14 10:26:52,092] [    INFO] train.py:84 - total_steps: 5450
Training: 2025-03-14 10:26:52,092 - total_steps: 5450
[2025-03-14 10:26:52,092] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 10:26:52,092 - total_epoch: 25
[2025-03-14 10:26:52,092] [    INFO] train.py:86 - decay_steps: [2180, 3488, 4796]
Training: 2025-03-14 10:26:52,092 - decay_steps: [2180, 3488, 4796]
I0314 10:26:53.345626 496603 program_interpreter.cc:212] New Executor is Running.
W0314 10:26:53.352955 496603 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 10:26:53.354506 496603 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1927, in _run_impl
    self._feed_data(program, feed, feed_var_name, scope)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1293, in _feed_data
    check_feed_shape_type(var, cur_feed)
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 253, in check_feed_shape_type
    raise ValueError(
ValueError: The fed Variable 'image' should have dimensions = 4, shape = (-1, 3, 112, 112), but received fed shape [32, 3, 224, 224] on each device
[2025-03-14 10:36:31,599] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 10:36:31,599 - rank: 0
[2025-03-14 10:36:31,599] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 10:36:31,599 - --------args----------
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 10:36:31,599 - config_file: configs/my_custom_dataset.py
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 10:36:31,599 - is_static: True
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 10:36:31,599 - backbone: FresResNet50
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 10:36:31,599 - classifier: LargeScaleClassifier
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 10:36:31,599 - embedding_size: 512
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 10:36:31,599 - model_parallel: True
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 10:36:31,599 - sample_ratio: 0.1
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 10:36:31,599 - loss: ArcFace
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 10:36:31,599 - dropout: 0.0
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 10:36:31,599 - fp16: True
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 10:36:31,599 - init_loss_scaling: 27648.0
[2025-03-14 10:36:31,599] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 10:36:31,599 - max_loss_scaling: 128.0
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 10:36:31,600 - incr_every_n_steps: 2000
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 10:36:31,600 - decr_every_n_nan_or_inf: 1
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 10:36:31,600 - incr_ratio: 2.0
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 10:36:31,600 - decr_ratio: 0.5
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 10:36:31,600 - use_dynamic_loss_scaling: True
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 10:36:31,600 - custom_white_list: []
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 10:36:31,600 - custom_black_list: []
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 10:36:31,600 - lr: 0.01
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 10:36:31,600 - lr_decay: 0.1
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 10:36:31,600 - weight_decay: 0.0005
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 10:36:31,600 - momentum: 0.9
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 10:36:31,600 - train_unit: epoch
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 10:36:31,600 - warmup_num: 0
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 10:36:31,600 - train_num: 25
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 10:36:31,600 - decay_boundaries: [10, 16, 22]
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 10:36:31,600 - use_synthetic_dataset: False
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 10:36:31,600 - dataset: custom_dataset
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 10:36:31,600 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 10:36:31,600 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 10:36:31,600 - is_bin: False
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 10:36:31,600 - num_classes: 312
[2025-03-14 10:36:31,600] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 10:36:31,600 - batch_size: 32
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 10:36:31,601 - num_workers: 8
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 10:36:31,601 - do_validation_while_train: False
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 10:36:31,601 - validation_interval_step: 2000
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 10:36:31,601 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 10:36:31,601 - logdir: ./log
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 10:36:31,601 - log_interval_step: 100
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 10:36:31,601 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 10:36:31,601 - resume: False
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 10:36:31,601 - checkpoint_dir: None
[2025-03-14 10:36:31,601] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 10:36:31,601 - max_num_last_checkpoint: 1
[2025-03-14 10:36:31,601] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 10:36:31,601 - ------------------------

[2025-03-14 10:36:31,605] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 10:36:31,605 - read label file finished, total num: 7182
[2025-03-14 10:36:31,605] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 10:36:31,605 - world_size: 1
[2025-03-14 10:36:31,605] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 10:36:31,605 - total_batch_size: 32
[2025-03-14 10:36:31,605] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 10:36:31,605 - warmup_steps: 0
[2025-03-14 10:36:31,605] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 10:36:31,605 - steps_per_epoch: 224
[2025-03-14 10:36:31,605] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 10:36:31,605 - total_steps: 5600
[2025-03-14 10:36:31,605] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 10:36:31,605 - total_epoch: 25
[2025-03-14 10:36:31,606] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 10:36:31,606 - decay_steps: [2240, 3584, 4928]
I0314 10:36:32.816212 499754 program_interpreter.cc:212] New Executor is Running.
W0314 10:36:32.823962 499754 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 10:36:32.825428 499754 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 95, in __init__
      fc1 = self.get_fc1(input_blob, is_train, dropout)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 195, in get_fc1
      fc1 = paddle.static.nn.fc(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/decorator.py", line 235, in fun
      return caller(func, *(extras + args), **kw)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/wrapped_decorator.py", line 26, in __impl__
      return wrapped_func(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 617, in __impl__
      return func(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 239, in fc
      return fc_base(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 214, in fc_base
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: The third-party dynamic library (libcublas.so) that Paddle depends on is not configured correctly. (error code is libcublas.so: cannot open shared object file: No such file or directory)
      Suggestions:
      1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
      2. Configure third-party dynamic library environment variables as follows:
      - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
      - Windows: set PATH by `set PATH=XXX; (at /paddle/paddle/phi/backends/dynload/dynamic_loader.cc:312)
      [operator < mul > error]
[2025-03-14 10:49:40,162] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 10:49:40,162 - rank: 0
[2025-03-14 10:49:40,162] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 10:49:40,162 - --------args----------
[2025-03-14 10:49:40,162] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 10:49:40,162 - config_file: configs/my_custom_dataset.py
[2025-03-14 10:49:40,162] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 10:49:40,162 - is_static: True
[2025-03-14 10:49:40,162] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 10:49:40,162 - backbone: FresResNet50
[2025-03-14 10:49:40,162] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 10:49:40,162 - classifier: LargeScaleClassifier
[2025-03-14 10:49:40,162] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 10:49:40,162 - embedding_size: 512
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 10:49:40,163 - model_parallel: True
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 10:49:40,163 - sample_ratio: 0.1
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 10:49:40,163 - loss: ArcFace
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 10:49:40,163 - dropout: 0.0
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 10:49:40,163 - fp16: True
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 10:49:40,163 - init_loss_scaling: 27648.0
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 10:49:40,163 - max_loss_scaling: 128.0
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 10:49:40,163 - incr_every_n_steps: 2000
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 10:49:40,163 - decr_every_n_nan_or_inf: 1
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 10:49:40,163 - incr_ratio: 2.0
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 10:49:40,163 - decr_ratio: 0.5
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 10:49:40,163 - use_dynamic_loss_scaling: True
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 10:49:40,163 - custom_white_list: []
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 10:49:40,163 - custom_black_list: []
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 10:49:40,163 - lr: 0.01
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 10:49:40,163 - lr_decay: 0.1
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 10:49:40,163 - weight_decay: 0.0005
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 10:49:40,163 - momentum: 0.9
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 10:49:40,163 - train_unit: epoch
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 10:49:40,163 - warmup_num: 0
[2025-03-14 10:49:40,163] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 10:49:40,163 - train_num: 25
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 10:49:40,164 - decay_boundaries: [10, 16, 22]
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 10:49:40,164 - use_synthetic_dataset: False
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 10:49:40,164 - dataset: custom_dataset
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 10:49:40,164 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 10:49:40,164 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 10:49:40,164 - is_bin: False
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 10:49:40,164 - num_classes: 312
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 10:49:40,164 - batch_size: 32
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 10:49:40,164 - num_workers: 8
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 10:49:40,164 - do_validation_while_train: False
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 10:49:40,164 - validation_interval_step: 2000
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 10:49:40,164 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 10:49:40,164 - logdir: ./log
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 10:49:40,164 - log_interval_step: 100
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 10:49:40,164 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 10:49:40,164 - resume: False
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 10:49:40,164 - checkpoint_dir: None
[2025-03-14 10:49:40,164] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 10:49:40,164 - max_num_last_checkpoint: 1
[2025-03-14 10:49:40,164] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 10:49:40,164 - ------------------------

[2025-03-14 10:49:40,167] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 10:49:40,167 - read label file finished, total num: 7182
[2025-03-14 10:49:40,167] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 10:49:40,167 - world_size: 1
[2025-03-14 10:49:40,167] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 10:49:40,167 - total_batch_size: 32
[2025-03-14 10:49:40,167] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 10:49:40,167 - warmup_steps: 0
[2025-03-14 10:49:40,167] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 10:49:40,167 - steps_per_epoch: 224
[2025-03-14 10:49:40,167] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 10:49:40,167 - total_steps: 5600
[2025-03-14 10:49:40,167] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 10:49:40,167 - total_epoch: 25
[2025-03-14 10:49:40,167] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 10:49:40,167 - decay_steps: [2240, 3584, 4928]
I0314 10:49:41.372224 502735 program_interpreter.cc:212] New Executor is Running.
W0314 10:49:41.379244 502735 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 10:49:41.380954 502735 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 69, in __init__
      self.backbone = eval(f"backbones.{self.backbone_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 233, in FresResNet50
      model = FresResNet(layers=50, **args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 95, in __init__
      fc1 = self.get_fc1(input_blob, is_train, dropout)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/backbones/iresnet.py", line 195, in get_fc1
      fc1 = paddle.static.nn.fc(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/decorator.py", line 235, in fun
      return caller(func, *(extras + args), **kw)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/wrapped_decorator.py", line 26, in __impl__
      return wrapped_func(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 617, in __impl__
      return func(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 239, in fc
      return fc_base(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/nn/common.py", line 214, in fc_base
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    PreconditionNotMetError: The third-party dynamic library (libcublas.so) that Paddle depends on is not configured correctly. (error code is libcublas.so: cannot open shared object file: No such file or directory)
      Suggestions:
      1. Check if the third-party dynamic library (e.g. CUDA, CUDNN) is installed correctly and its version is matched with paddlepaddle you installed.
      2. Configure third-party dynamic library environment variables as follows:
      - Linux: set LD_LIBRARY_PATH by `export LD_LIBRARY_PATH=...`
      - Windows: set PATH by `set PATH=XXX; (at /paddle/paddle/phi/backends/dynload/dynamic_loader.cc:312)
      [operator < mul > error]
[2025-03-14 11:02:49,065] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 11:02:49,065 - rank: 0
[2025-03-14 11:02:49,066] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 11:02:49,066 - --------args----------
[2025-03-14 11:02:49,066] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 11:02:49,066 - config_file: configs/my_custom_dataset.py
[2025-03-14 11:02:49,066] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 11:02:49,066 - is_static: True
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 11:02:49,067 - backbone: FresResNet50
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 11:02:49,067 - classifier: LargeScaleClassifier
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 11:02:49,067 - embedding_size: 512
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 11:02:49,067 - model_parallel: True
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 11:02:49,067 - sample_ratio: 0.1
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 11:02:49,067 - loss: ArcFace
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 11:02:49,067 - dropout: 0.0
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 11:02:49,067 - fp16: True
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 11:02:49,067 - init_loss_scaling: 27648.0
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 11:02:49,067 - max_loss_scaling: 128.0
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 11:02:49,067 - incr_every_n_steps: 2000
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 11:02:49,067 - decr_every_n_nan_or_inf: 1
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 11:02:49,067 - incr_ratio: 2.0
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 11:02:49,067 - decr_ratio: 0.5
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 11:02:49,067 - use_dynamic_loss_scaling: True
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 11:02:49,067 - custom_white_list: []
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 11:02:49,067 - custom_black_list: []
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 11:02:49,067 - lr: 0.01
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 11:02:49,067 - lr_decay: 0.1
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 11:02:49,067 - weight_decay: 0.0005
[2025-03-14 11:02:49,067] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 11:02:49,067 - momentum: 0.9
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 11:02:49,068 - train_unit: epoch
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 11:02:49,068 - warmup_num: 0
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 11:02:49,068 - train_num: 25
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 11:02:49,068 - decay_boundaries: [10, 16, 22]
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 11:02:49,068 - use_synthetic_dataset: False
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 11:02:49,068 - dataset: custom_dataset
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 11:02:49,068 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 11:02:49,068 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 11:02:49,068 - is_bin: False
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 11:02:49,068 - num_classes: 312
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 11:02:49,068 - batch_size: 32
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 11:02:49,068 - num_workers: 8
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 11:02:49,068 - do_validation_while_train: False
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 11:02:49,068 - validation_interval_step: 2000
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 11:02:49,068 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 11:02:49,068 - logdir: ./log
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 11:02:49,068 - log_interval_step: 100
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 11:02:49,068 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 11:02:49,068 - resume: False
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 11:02:49,068 - checkpoint_dir: None
[2025-03-14 11:02:49,068] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 11:02:49,068 - max_num_last_checkpoint: 1
[2025-03-14 11:02:49,068] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 11:02:49,068 - ------------------------

[2025-03-14 11:02:49,071] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 11:02:49,071 - read label file finished, total num: 7182
[2025-03-14 11:02:49,071] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 11:02:49,071 - world_size: 1
[2025-03-14 11:02:49,071] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 11:02:49,071 - total_batch_size: 32
[2025-03-14 11:02:49,072] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 11:02:49,072 - warmup_steps: 0
[2025-03-14 11:02:49,072] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 11:02:49,072 - steps_per_epoch: 224
[2025-03-14 11:02:49,072] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 11:02:49,072 - total_steps: 5600
[2025-03-14 11:02:49,072] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 11:02:49,072 - total_epoch: 25
[2025-03-14 11:02:49,072] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 11:02:49,072 - decay_steps: [2240, 3584, 4928]
I0314 11:02:50.291514 525618 program_interpreter.cc:212] New Executor is Running.
W0314 11:02:50.298724 525618 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 11:02:50.299981 525618 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 74, in __init__
      self.classifier = eval(f"classifiers.{self.classifier_class_name}")(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 114, in __init__
      local_logit = paddle.matmul(norm_feature, norm_weight)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/tensor/linalg.py", line 268, in matmul
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: Input(X) has error dim.X'dims[1] must be equal to 31But received X'dims[1] is 512
      [Hint: Expected x_dims[x_ndim - 1] == N, but received x_dims[x_ndim - 1]:512 != N:31.] (at /paddle/paddle/phi/kernels/impl/matmul_kernel_impl.h:250)
      [operator < matmul_v2 > error]
[2025-03-14 11:11:03,013] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 11:11:03,013 - rank: 0
[2025-03-14 11:11:03,013] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 11:11:03,013 - --------args----------
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 11:11:03,013 - config_file: configs/my_custom_dataset.py
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 11:11:03,013 - is_static: True
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 11:11:03,013 - backbone: FresResNet50
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 11:11:03,013 - classifier: LargeScaleClassifier
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 11:11:03,013 - embedding_size: 512
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 11:11:03,013 - model_parallel: True
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 11:11:03,013 - sample_ratio: 0.1
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 11:11:03,013 - loss: ArcFace
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 11:11:03,013 - dropout: 0.0
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 11:11:03,013 - fp16: True
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 11:11:03,013 - init_loss_scaling: 27648.0
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 11:11:03,013 - max_loss_scaling: 128.0
[2025-03-14 11:11:03,013] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 11:11:03,013 - incr_every_n_steps: 2000
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 11:11:03,014 - decr_every_n_nan_or_inf: 1
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 11:11:03,014 - incr_ratio: 2.0
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 11:11:03,014 - decr_ratio: 0.5
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 11:11:03,014 - use_dynamic_loss_scaling: True
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 11:11:03,014 - custom_white_list: []
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 11:11:03,014 - custom_black_list: []
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 11:11:03,014 - lr: 0.01
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 11:11:03,014 - lr_decay: 0.1
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 11:11:03,014 - weight_decay: 0.0005
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 11:11:03,014 - momentum: 0.9
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 11:11:03,014 - train_unit: epoch
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 11:11:03,014 - warmup_num: 0
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 11:11:03,014 - train_num: 25
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 11:11:03,014 - decay_boundaries: [10, 16, 22]
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 11:11:03,014 - use_synthetic_dataset: False
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 11:11:03,014 - dataset: custom_dataset
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 11:11:03,014 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 11:11:03,014 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 11:11:03,014 - is_bin: False
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 11:11:03,014 - num_classes: 312
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 11:11:03,014 - batch_size: 32
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 11:11:03,014 - num_workers: 8
[2025-03-14 11:11:03,014] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 11:11:03,014 - do_validation_while_train: False
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 11:11:03,015 - validation_interval_step: 2000
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 11:11:03,015 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 11:11:03,015 - logdir: ./log
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 11:11:03,015 - log_interval_step: 100
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 11:11:03,015 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 11:11:03,015 - resume: False
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 11:11:03,015 - checkpoint_dir: None
[2025-03-14 11:11:03,015] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 11:11:03,015 - max_num_last_checkpoint: 1
[2025-03-14 11:11:03,015] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 11:11:03,015 - ------------------------

[2025-03-14 11:11:03,017] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 11:11:03,017 - read label file finished, total num: 7182
[2025-03-14 11:11:03,018] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 11:11:03,018 - world_size: 1
[2025-03-14 11:11:03,018] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 11:11:03,018 - total_batch_size: 32
[2025-03-14 11:11:03,018] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 11:11:03,018 - warmup_steps: 0
[2025-03-14 11:11:03,018] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 11:11:03,018 - steps_per_epoch: 224
[2025-03-14 11:11:03,018] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 11:11:03,018 - total_steps: 5600
[2025-03-14 11:11:03,018] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 11:11:03,018 - total_epoch: 25
[2025-03-14 11:11:03,018] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 11:11:03,018 - decay_steps: [2240, 3584, 4928]
I0314 11:11:04.241663 527622 program_interpreter.cc:212] New Executor is Running.
W0314 11:11:04.248832 527622 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 11:11:04.250027 527622 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 11:11:06.525368 527622 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
[2025-03-14 11:13:28,415] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 11:13:28,415 - rank: 0
[2025-03-14 11:13:28,415] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 11:13:28,415 - --------args----------
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 11:13:28,415 - config_file: configs/my_custom_dataset.py
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 11:13:28,415 - is_static: True
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 11:13:28,415 - backbone: FresResNet50
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 11:13:28,415 - classifier: LargeScaleClassifier
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 11:13:28,415 - embedding_size: 512
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 11:13:28,415 - model_parallel: True
[2025-03-14 11:13:28,415] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 11:13:28,415 - sample_ratio: 0.1
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 11:13:28,416 - loss: ArcFace
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 11:13:28,416 - dropout: 0.0
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 11:13:28,416 - fp16: True
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 11:13:28,416 - init_loss_scaling: 27648.0
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 11:13:28,416 - max_loss_scaling: 128.0
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 11:13:28,416 - incr_every_n_steps: 2000
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 11:13:28,416 - decr_every_n_nan_or_inf: 1
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 11:13:28,416 - incr_ratio: 2.0
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 11:13:28,416 - decr_ratio: 0.5
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 11:13:28,416 - use_dynamic_loss_scaling: True
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 11:13:28,416 - custom_white_list: []
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 11:13:28,416 - custom_black_list: []
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 11:13:28,416 - lr: 0.01
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 11:13:28,416 - lr_decay: 0.1
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 11:13:28,416 - weight_decay: 0.0005
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 11:13:28,416 - momentum: 0.9
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 11:13:28,416 - train_unit: epoch
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 11:13:28,416 - warmup_num: 0
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 11:13:28,416 - train_num: 25
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 11:13:28,416 - decay_boundaries: [10, 16, 22]
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 11:13:28,416 - use_synthetic_dataset: False
[2025-03-14 11:13:28,416] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 11:13:28,416 - dataset: custom_dataset
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 11:13:28,417 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 11:13:28,417 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 11:13:28,417 - is_bin: False
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 11:13:28,417 - num_classes: 312
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 11:13:28,417 - batch_size: 32
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 11:13:28,417 - num_workers: 8
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 11:13:28,417 - do_validation_while_train: False
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 11:13:28,417 - validation_interval_step: 2000
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 11:13:28,417 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 11:13:28,417 - logdir: ./log
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 11:13:28,417 - log_interval_step: 100
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 11:13:28,417 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 11:13:28,417 - resume: False
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 11:13:28,417 - checkpoint_dir: None
[2025-03-14 11:13:28,417] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 11:13:28,417 - max_num_last_checkpoint: 1
[2025-03-14 11:13:28,417] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 11:13:28,417 - ------------------------

[2025-03-14 11:13:28,420] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 11:13:28,420 - read label file finished, total num: 7182
[2025-03-14 11:13:28,420] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 11:13:28,420 - world_size: 1
[2025-03-14 11:13:28,420] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 11:13:28,420 - total_batch_size: 32
[2025-03-14 11:13:28,420] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 11:13:28,420 - warmup_steps: 0
[2025-03-14 11:13:28,420] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 11:13:28,420 - steps_per_epoch: 224
[2025-03-14 11:13:28,420] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 11:13:28,420 - total_steps: 5600
[2025-03-14 11:13:28,420] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 11:13:28,420 - total_epoch: 25
[2025-03-14 11:13:28,420] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 11:13:28,420 - decay_steps: [2240, 3584, 4928]
I0314 11:13:29.628027 528456 program_interpreter.cc:212] New Executor is Running.
W0314 11:13:29.635303 528456 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 11:13:29.636529 528456 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 11:13:32.113363 528456 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
RuntimeError: (NotFound) dist@fc@rank@00000.w.w_0.cast_fp16@GRAD not in VariableScope.
  [Hint: Expected HasVar(name) == true, but received HasVar(name):0 != true:1.] (at /paddle/paddle/fluid/framework/new_executor/new_executor_defs.cc:151)

[2025-03-14 11:15:15,009] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 11:15:15,009 - rank: 0
[2025-03-14 11:15:15,010] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 11:15:15,010 - --------args----------
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 11:15:15,010 - config_file: configs/my_custom_dataset.py
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 11:15:15,010 - is_static: True
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 11:15:15,010 - backbone: FresResNet50
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 11:15:15,010 - classifier: LargeScaleClassifier
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 11:15:15,010 - embedding_size: 512
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 11:15:15,010 - model_parallel: True
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 11:15:15,010 - sample_ratio: 0.1
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 11:15:15,010 - loss: ArcFace
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 11:15:15,010 - dropout: 0.0
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 11:15:15,010 - fp16: True
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 11:15:15,010 - init_loss_scaling: 27648.0
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 11:15:15,010 - max_loss_scaling: 128.0
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 11:15:15,010 - incr_every_n_steps: 2000
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 11:15:15,010 - decr_every_n_nan_or_inf: 1
[2025-03-14 11:15:15,010] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 11:15:15,010 - incr_ratio: 2.0
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 11:15:15,011 - decr_ratio: 0.5
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 11:15:15,011 - use_dynamic_loss_scaling: True
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 11:15:15,011 - custom_white_list: []
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 11:15:15,011 - custom_black_list: []
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 11:15:15,011 - lr: 0.01
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 11:15:15,011 - lr_decay: 0.1
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 11:15:15,011 - weight_decay: 0.0005
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 11:15:15,011 - momentum: 0.9
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 11:15:15,011 - train_unit: epoch
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 11:15:15,011 - warmup_num: 0
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 11:15:15,011 - train_num: 25
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 11:15:15,011 - decay_boundaries: [10, 16, 22]
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 11:15:15,011 - use_synthetic_dataset: False
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 11:15:15,011 - dataset: custom_dataset
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 11:15:15,011 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 11:15:15,011 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 11:15:15,011 - is_bin: False
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 11:15:15,011 - num_classes: 312
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 11:15:15,011 - batch_size: 32
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 11:15:15,011 - num_workers: 8
[2025-03-14 11:15:15,011] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 11:15:15,011 - do_validation_while_train: False
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 11:15:15,012 - validation_interval_step: 2000
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 11:15:15,012 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 11:15:15,012 - logdir: ./log
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 11:15:15,012 - log_interval_step: 100
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 11:15:15,012 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 11:15:15,012 - resume: False
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 11:15:15,012 - checkpoint_dir: None
[2025-03-14 11:15:15,012] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 11:15:15,012 - max_num_last_checkpoint: 1
[2025-03-14 11:15:15,012] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 11:15:15,012 - ------------------------

[2025-03-14 11:15:15,014] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 11:15:15,014 - read label file finished, total num: 7182
[2025-03-14 11:15:15,014] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 11:15:15,014 - world_size: 1
[2025-03-14 11:15:15,014] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 11:15:15,014 - total_batch_size: 32
[2025-03-14 11:15:15,014] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 11:15:15,014 - warmup_steps: 0
[2025-03-14 11:15:15,015] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 11:15:15,015 - steps_per_epoch: 224
[2025-03-14 11:15:15,015] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 11:15:15,015 - total_steps: 5600
[2025-03-14 11:15:15,015] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 11:15:15,015 - total_epoch: 25
[2025-03-14 11:15:15,015] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 11:15:15,015 - decay_steps: [2240, 3584, 4928]
I0314 11:15:16.239090 529156 program_interpreter.cc:212] New Executor is Running.
W0314 11:15:16.246184 529156 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 11:15:16.247431 529156 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 11:15:18.709658 529156 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
[2025-03-14 11:16:24,555] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 11:16:24,555 - rank: 0
[2025-03-14 11:16:24,556] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 11:16:24,556 - --------args----------
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 11:16:24,556 - config_file: configs/my_custom_dataset.py
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 11:16:24,556 - is_static: True
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 11:16:24,556 - backbone: FresResNet50
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 11:16:24,556 - classifier: LargeScaleClassifier
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 11:16:24,556 - embedding_size: 512
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 11:16:24,556 - model_parallel: True
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 11:16:24,556 - sample_ratio: 0.1
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 11:16:24,556 - loss: ArcFace
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 11:16:24,556 - dropout: 0.0
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 11:16:24,556 - fp16: True
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 11:16:24,556 - init_loss_scaling: 27648.0
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 11:16:24,556 - max_loss_scaling: 128.0
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 11:16:24,556 - incr_every_n_steps: 2000
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 11:16:24,556 - decr_every_n_nan_or_inf: 1
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 11:16:24,556 - incr_ratio: 2.0
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 11:16:24,556 - decr_ratio: 0.5
[2025-03-14 11:16:24,556] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 11:16:24,556 - use_dynamic_loss_scaling: True
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 11:16:24,557 - custom_white_list: []
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 11:16:24,557 - custom_black_list: []
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 11:16:24,557 - lr: 0.01
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 11:16:24,557 - lr_decay: 0.1
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 11:16:24,557 - weight_decay: 0.0005
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 11:16:24,557 - momentum: 0.9
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 11:16:24,557 - train_unit: epoch
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 11:16:24,557 - warmup_num: 0
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 11:16:24,557 - train_num: 25
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 11:16:24,557 - decay_boundaries: [10, 16, 22]
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 11:16:24,557 - use_synthetic_dataset: False
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 11:16:24,557 - dataset: custom_dataset
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 11:16:24,557 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 11:16:24,557 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 11:16:24,557 - is_bin: False
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 11:16:24,557 - num_classes: 312
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 11:16:24,557 - batch_size: 32
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 11:16:24,557 - num_workers: 8
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 11:16:24,557 - do_validation_while_train: False
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 11:16:24,557 - validation_interval_step: 2000
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 11:16:24,557 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 11:16:24,557] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 11:16:24,557 - logdir: ./log
[2025-03-14 11:16:24,558] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 11:16:24,558 - log_interval_step: 100
[2025-03-14 11:16:24,558] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 11:16:24,558 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 11:16:24,558] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 11:16:24,558 - resume: False
[2025-03-14 11:16:24,558] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 11:16:24,558 - checkpoint_dir: None
[2025-03-14 11:16:24,558] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 11:16:24,558 - max_num_last_checkpoint: 1
[2025-03-14 11:16:24,558] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 11:16:24,558 - ------------------------

[2025-03-14 11:16:24,560] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 11:16:24,560 - read label file finished, total num: 7182
[2025-03-14 11:16:24,560] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 11:16:24,560 - world_size: 1
[2025-03-14 11:16:24,560] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 11:16:24,560 - total_batch_size: 32
[2025-03-14 11:16:24,560] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 11:16:24,560 - warmup_steps: 0
[2025-03-14 11:16:24,560] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 11:16:24,560 - steps_per_epoch: 224
[2025-03-14 11:16:24,560] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 11:16:24,560 - total_steps: 5600
[2025-03-14 11:16:24,560] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 11:16:24,560 - total_epoch: 25
[2025-03-14 11:16:24,560] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 11:16:24,560 - decay_steps: [2240, 3584, 4928]
I0314 11:16:25.775851 529693 program_interpreter.cc:212] New Executor is Running.
W0314 11:16:25.783401 529693 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 11:16:25.784678 529693 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 11:16:28.027164 529693 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 28, in <module>
    from .static_model import StaticModel
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 20, in <module>
    from . import classifiers
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/__init__.py", line 15, in <module>
    from .lsc import LargeScaleClassifier
ModuleNotFoundError: No module named 'static.classifiers.lsc'
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 26, in <module>
    from static.train import train
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 28, in <module>
    from .static_model import StaticModel
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 20, in <module>
    from . import classifiers
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/__init__.py", line 15, in <module>
    from .lsc import LargeScaleClassifier
ModuleNotFoundError: No module named 'static.classifiers.lsc'
[2025-03-14 12:25:24,510] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 12:25:24,510 - rank: 0
[2025-03-14 12:25:24,510] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 12:25:24,510 - --------args----------
[2025-03-14 12:25:24,510] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 12:25:24,510 - config_file: configs/my_custom_dataset.py
[2025-03-14 12:25:24,510] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 12:25:24,510 - is_static: True
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 12:25:24,511 - backbone: FresResNet50
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 12:25:24,511 - classifier: LargeScaleClassifier
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 12:25:24,511 - embedding_size: 512
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 12:25:24,511 - model_parallel: True
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 12:25:24,511 - sample_ratio: 0.1
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 12:25:24,511 - loss: ArcFace
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 12:25:24,511 - dropout: 0.0
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 12:25:24,511 - fp16: True
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 12:25:24,511 - init_loss_scaling: 27648.0
[2025-03-14 12:25:24,511] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 12:25:24,511 - max_loss_scaling: 128.0
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 12:25:24,512 - incr_every_n_steps: 2000
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 12:25:24,512 - decr_every_n_nan_or_inf: 1
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 12:25:24,512 - incr_ratio: 2.0
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 12:25:24,512 - decr_ratio: 0.5
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 12:25:24,512 - use_dynamic_loss_scaling: True
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 12:25:24,512 - custom_white_list: []
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 12:25:24,512 - custom_black_list: []
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 12:25:24,512 - lr: 0.01
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 12:25:24,512 - lr_decay: 0.1
[2025-03-14 12:25:24,512] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 12:25:24,512 - weight_decay: 0.0005
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 12:25:24,513 - momentum: 0.9
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 12:25:24,513 - train_unit: epoch
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 12:25:24,513 - warmup_num: 0
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 12:25:24,513 - train_num: 25
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 12:25:24,513 - decay_boundaries: [10, 16, 22]
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 12:25:24,513 - use_synthetic_dataset: False
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 12:25:24,513 - dataset: custom_dataset
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 12:25:24,513 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 12:25:24,513 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 12:25:24,513] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 12:25:24,513 - is_bin: False
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 12:25:24,514 - num_classes: 312
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 12:25:24,514 - batch_size: 32
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 12:25:24,514 - num_workers: 8
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 12:25:24,514 - do_validation_while_train: False
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 12:25:24,514 - validation_interval_step: 2000
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 12:25:24,514 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 12:25:24,514 - logdir: ./log
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 12:25:24,514 - log_interval_step: 100
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 12:25:24,514 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 12:25:24,514] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 12:25:24,514 - resume: False
[2025-03-14 12:25:24,515] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 12:25:24,515 - checkpoint_dir: None
[2025-03-14 12:25:24,515] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 12:25:24,515 - max_num_last_checkpoint: 1
[2025-03-14 12:25:24,515] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 12:25:24,515 - ------------------------

[2025-03-14 12:25:24,518] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 12:25:24,518 - read label file finished, total num: 7182
[2025-03-14 12:25:24,518] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 12:25:24,518 - world_size: 1
[2025-03-14 12:25:24,518] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 12:25:24,518 - total_batch_size: 32
[2025-03-14 12:25:24,518] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 12:25:24,518 - warmup_steps: 0
[2025-03-14 12:25:24,518] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 12:25:24,518 - steps_per_epoch: 224
[2025-03-14 12:25:24,518] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 12:25:24,518 - total_steps: 5600
[2025-03-14 12:25:24,519] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 12:25:24,519 - total_epoch: 25
[2025-03-14 12:25:24,519] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 12:25:24,519 - decay_steps: [2240, 3584, 4928]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 74, in __init__
    self.classifier = eval(f"classifiers.{self.classifier_class_name}")(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 110, in __init__
    norm_feature = paddle.fluid.layers.l2_normalize(total_feature, axis=1)
                   ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-14 12:28:40,344] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 12:28:40,344 - rank: 0
[2025-03-14 12:28:40,345] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 12:28:40,345 - --------args----------
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 12:28:40,345 - config_file: configs/my_custom_dataset.py
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 12:28:40,345 - is_static: True
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 12:28:40,345 - backbone: FresResNet50
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 12:28:40,345 - classifier: LargeScaleClassifier
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 12:28:40,345 - embedding_size: 512
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 12:28:40,345 - model_parallel: True
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 12:28:40,345 - sample_ratio: 0.1
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 12:28:40,345 - loss: ArcFace
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 12:28:40,345 - dropout: 0.0
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 12:28:40,345 - fp16: True
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 12:28:40,345 - init_loss_scaling: 27648.0
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 12:28:40,345 - max_loss_scaling: 128.0
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 12:28:40,345 - incr_every_n_steps: 2000
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 12:28:40,345 - decr_every_n_nan_or_inf: 1
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 12:28:40,345 - incr_ratio: 2.0
[2025-03-14 12:28:40,345] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 12:28:40,345 - decr_ratio: 0.5
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 12:28:40,346 - use_dynamic_loss_scaling: True
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 12:28:40,346 - custom_white_list: []
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 12:28:40,346 - custom_black_list: []
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 12:28:40,346 - lr: 0.01
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 12:28:40,346 - lr_decay: 0.1
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 12:28:40,346 - weight_decay: 0.0005
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 12:28:40,346 - momentum: 0.9
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 12:28:40,346 - train_unit: epoch
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 12:28:40,346 - warmup_num: 0
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 12:28:40,346 - train_num: 25
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 12:28:40,346 - decay_boundaries: [10, 16, 22]
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 12:28:40,346 - use_synthetic_dataset: False
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 12:28:40,346 - dataset: custom_dataset
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 12:28:40,346 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 12:28:40,346 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 12:28:40,346 - is_bin: False
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 12:28:40,346 - num_classes: 312
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 12:28:40,346 - batch_size: 32
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 12:28:40,346 - num_workers: 8
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 12:28:40,346 - do_validation_while_train: False
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 12:28:40,346 - validation_interval_step: 2000
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 12:28:40,346 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 12:28:40,346] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 12:28:40,346 - logdir: ./log
[2025-03-14 12:28:40,347] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 12:28:40,347 - log_interval_step: 100
[2025-03-14 12:28:40,347] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 12:28:40,347 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 12:28:40,347] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 12:28:40,347 - resume: False
[2025-03-14 12:28:40,347] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 12:28:40,347 - checkpoint_dir: None
[2025-03-14 12:28:40,347] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 12:28:40,347 - max_num_last_checkpoint: 1
[2025-03-14 12:28:40,347] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 12:28:40,347 - ------------------------

[2025-03-14 12:28:40,379] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 12:28:40,379 - read label file finished, total num: 7182
[2025-03-14 12:28:40,379] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 12:28:40,379 - world_size: 1
[2025-03-14 12:28:40,379] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 12:28:40,379 - total_batch_size: 32
[2025-03-14 12:28:40,379] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 12:28:40,379 - warmup_steps: 0
[2025-03-14 12:28:40,379] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 12:28:40,379 - steps_per_epoch: 224
[2025-03-14 12:28:40,380] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 12:28:40,380 - total_steps: 5600
[2025-03-14 12:28:40,380] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 12:28:40,380 - total_epoch: 25
[2025-03-14 12:28:40,380] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 12:28:40,380 - decay_steps: [2240, 3584, 4928]
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
    train_model = StaticModel(
                  ^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 74, in __init__
    self.classifier = eval(f"classifiers.{self.classifier_class_name}")(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/src/insightface/recognition/arcface_paddle/static/classifiers/lsc.py", line 110, in __init__
    norm_feature = paddle.fluid.layers.l2_normalize(total_feature, axis=1)
                   ^^^^^^^^^^^^
AttributeError: module 'paddle' has no attribute 'fluid'. Did you mean: 'flip'?
[2025-03-14 12:47:44,364] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 12:47:44,364 - rank: 0
[2025-03-14 12:47:44,365] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 12:47:44,365 - --------args----------
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 12:47:44,365 - config_file: configs/my_custom_dataset.py
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 12:47:44,365 - is_static: True
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 12:47:44,365 - backbone: FresResNet50
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 12:47:44,365 - classifier: LargeScaleClassifier
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 12:47:44,365 - embedding_size: 512
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 12:47:44,365 - model_parallel: True
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 12:47:44,365 - sample_ratio: 0.1
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 12:47:44,365 - loss: ArcFace
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 12:47:44,365 - dropout: 0.0
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 12:47:44,365 - fp16: True
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 12:47:44,365 - init_loss_scaling: 27648.0
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 12:47:44,365 - max_loss_scaling: 128.0
[2025-03-14 12:47:44,365] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 12:47:44,365 - incr_every_n_steps: 2000
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 12:47:44,366 - decr_every_n_nan_or_inf: 1
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 12:47:44,366 - incr_ratio: 2.0
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 12:47:44,366 - decr_ratio: 0.5
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 12:47:44,366 - use_dynamic_loss_scaling: True
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 12:47:44,366 - custom_white_list: []
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 12:47:44,366 - custom_black_list: []
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 12:47:44,366 - lr: 0.01
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 12:47:44,366 - lr_decay: 0.1
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 12:47:44,366 - weight_decay: 0.0005
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 12:47:44,366 - momentum: 0.9
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 12:47:44,366 - train_unit: epoch
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 12:47:44,366 - warmup_num: 0
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 12:47:44,366 - train_num: 25
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 12:47:44,366 - decay_boundaries: [10, 16, 22]
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 12:47:44,366 - use_synthetic_dataset: False
[2025-03-14 12:47:44,366] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 12:47:44,366 - dataset: custom_dataset
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 12:47:44,367 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 12:47:44,367 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 12:47:44,367 - is_bin: False
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 12:47:44,367 - num_classes: 312
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 12:47:44,367 - batch_size: 32
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 12:47:44,367 - num_workers: 8
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 12:47:44,367 - do_validation_while_train: False
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 12:47:44,367 - validation_interval_step: 2000
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 12:47:44,367 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 12:47:44,367 - logdir: ./log
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 12:47:44,367 - log_interval_step: 100
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 12:47:44,367 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 12:47:44,367 - resume: False
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 12:47:44,367 - checkpoint_dir: None
[2025-03-14 12:47:44,367] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 12:47:44,367 - max_num_last_checkpoint: 1
[2025-03-14 12:47:44,367] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 12:47:44,367 - ------------------------

[2025-03-14 12:47:44,400] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 12:47:44,400 - read label file finished, total num: 7182
[2025-03-14 12:47:44,401] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 12:47:44,401 - world_size: 1
[2025-03-14 12:47:44,401] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 12:47:44,401 - total_batch_size: 32
[2025-03-14 12:47:44,401] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 12:47:44,401 - warmup_steps: 0
[2025-03-14 12:47:44,401] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 12:47:44,401 - steps_per_epoch: 224
[2025-03-14 12:47:44,401] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 12:47:44,401 - total_steps: 5600
[2025-03-14 12:47:44,401] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 12:47:44,401 - total_epoch: 25
[2025-03-14 12:47:44,401] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 12:47:44,401 - decay_steps: [2240, 3584, 4928]
I0314 12:47:46.419307 558080 program_interpreter.cc:212] New Executor is Running.
W0314 12:47:46.429613 558080 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 12:47:46.430827 558080 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 12:47:50.705271 558080 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
[2025-03-14 12:52:35,351] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 12:52:35,351 - rank: 0
[2025-03-14 12:52:35,351] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 12:52:35,351 - --------args----------
[2025-03-14 12:52:35,351] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 12:52:35,351 - config_file: configs/my_custom_dataset.py
[2025-03-14 12:52:35,351] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 12:52:35,351 - is_static: True
[2025-03-14 12:52:35,351] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 12:52:35,351 - backbone: FresResNet50
[2025-03-14 12:52:35,351] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 12:52:35,351 - classifier: LargeScaleClassifier
[2025-03-14 12:52:35,351] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 12:52:35,351 - embedding_size: 512
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 12:52:35,352 - model_parallel: True
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 12:52:35,352 - sample_ratio: 0.1
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 12:52:35,352 - loss: ArcFace
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 12:52:35,352 - dropout: 0.0
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 12:52:35,352 - fp16: True
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 12:52:35,352 - init_loss_scaling: 27648.0
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 12:52:35,352 - max_loss_scaling: 128.0
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 12:52:35,352 - incr_every_n_steps: 2000
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 12:52:35,352 - decr_every_n_nan_or_inf: 1
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 12:52:35,352 - incr_ratio: 2.0
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 12:52:35,352 - decr_ratio: 0.5
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 12:52:35,352 - use_dynamic_loss_scaling: True
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 12:52:35,352 - custom_white_list: []
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 12:52:35,352 - custom_black_list: []
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 12:52:35,352 - lr: 0.01
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 12:52:35,352 - lr_decay: 0.1
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 12:52:35,352 - weight_decay: 0.0005
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 12:52:35,352 - momentum: 0.9
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 12:52:35,352 - train_unit: epoch
[2025-03-14 12:52:35,352] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 12:52:35,352 - warmup_num: 0
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 12:52:35,353 - train_num: 25
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 12:52:35,353 - decay_boundaries: [10, 16, 22]
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 12:52:35,353 - use_synthetic_dataset: False
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 12:52:35,353 - dataset: custom_dataset
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 12:52:35,353 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 12:52:35,353 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 12:52:35,353 - is_bin: False
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 12:52:35,353 - num_classes: 312
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 12:52:35,353 - batch_size: 32
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 12:52:35,353 - num_workers: 8
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 12:52:35,353 - do_validation_while_train: False
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 12:52:35,353 - validation_interval_step: 2000
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 12:52:35,353 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 12:52:35,353 - logdir: ./log
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 12:52:35,353 - log_interval_step: 100
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 12:52:35,353 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 12:52:35,353 - resume: False
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 12:52:35,353 - checkpoint_dir: None
[2025-03-14 12:52:35,353] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 12:52:35,353 - max_num_last_checkpoint: 1
[2025-03-14 12:52:35,353] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 12:52:35,353 - ------------------------

[2025-03-14 12:52:35,356] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 12:52:35,356 - read label file finished, total num: 7182
[2025-03-14 12:52:35,356] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 12:52:35,356 - world_size: 1
[2025-03-14 12:52:35,356] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 12:52:35,356 - total_batch_size: 32
[2025-03-14 12:52:35,356] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 12:52:35,356 - warmup_steps: 0
[2025-03-14 12:52:35,356] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 12:52:35,356 - steps_per_epoch: 224
[2025-03-14 12:52:35,356] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 12:52:35,356 - total_steps: 5600
[2025-03-14 12:52:35,356] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 12:52:35,356 - total_epoch: 25
[2025-03-14 12:52:35,356] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 12:52:35,356 - decay_steps: [2240, 3584, 4928]
I0314 12:52:39.382486 560032 program_interpreter.cc:212] New Executor is Running.
W0314 12:52:39.409688 560032 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 12:52:39.447700 560032 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 12:52:45.453536 560032 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
[2025-03-14 12:55:07,958] [    INFO] logging.py:57 - rank: 0
Training: 2025-03-14 12:55:07,958 - rank: 0
[2025-03-14 12:55:07,958] [    INFO] argparser.py:22 - --------args----------
Training: 2025-03-14 12:55:07,958 - --------args----------
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - config_file: configs/my_custom_dataset.py
Training: 2025-03-14 12:55:07,959 - config_file: configs/my_custom_dataset.py
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - is_static: True
Training: 2025-03-14 12:55:07,959 - is_static: True
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - backbone: FresResNet50
Training: 2025-03-14 12:55:07,959 - backbone: FresResNet50
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - classifier: LargeScaleClassifier
Training: 2025-03-14 12:55:07,959 - classifier: LargeScaleClassifier
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - embedding_size: 512
Training: 2025-03-14 12:55:07,959 - embedding_size: 512
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - model_parallel: True
Training: 2025-03-14 12:55:07,959 - model_parallel: True
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - sample_ratio: 0.1
Training: 2025-03-14 12:55:07,959 - sample_ratio: 0.1
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - loss: ArcFace
Training: 2025-03-14 12:55:07,959 - loss: ArcFace
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - dropout: 0.0
Training: 2025-03-14 12:55:07,959 - dropout: 0.0
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - fp16: True
Training: 2025-03-14 12:55:07,959 - fp16: True
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - init_loss_scaling: 27648.0
Training: 2025-03-14 12:55:07,959 - init_loss_scaling: 27648.0
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - max_loss_scaling: 128.0
Training: 2025-03-14 12:55:07,959 - max_loss_scaling: 128.0
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - incr_every_n_steps: 2000
Training: 2025-03-14 12:55:07,959 - incr_every_n_steps: 2000
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - decr_every_n_nan_or_inf: 1
Training: 2025-03-14 12:55:07,959 - decr_every_n_nan_or_inf: 1
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - incr_ratio: 2.0
Training: 2025-03-14 12:55:07,959 - incr_ratio: 2.0
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - decr_ratio: 0.5
Training: 2025-03-14 12:55:07,959 - decr_ratio: 0.5
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - use_dynamic_loss_scaling: True
Training: 2025-03-14 12:55:07,959 - use_dynamic_loss_scaling: True
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - custom_white_list: []
Training: 2025-03-14 12:55:07,959 - custom_white_list: []
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - custom_black_list: []
Training: 2025-03-14 12:55:07,959 - custom_black_list: []
[2025-03-14 12:55:07,959] [    INFO] argparser.py:24 - lr: 0.01
Training: 2025-03-14 12:55:07,959 - lr: 0.01
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - lr_decay: 0.1
Training: 2025-03-14 12:55:07,960 - lr_decay: 0.1
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - weight_decay: 0.0005
Training: 2025-03-14 12:55:07,960 - weight_decay: 0.0005
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - momentum: 0.9
Training: 2025-03-14 12:55:07,960 - momentum: 0.9
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - train_unit: epoch
Training: 2025-03-14 12:55:07,960 - train_unit: epoch
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - warmup_num: 0
Training: 2025-03-14 12:55:07,960 - warmup_num: 0
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - train_num: 25
Training: 2025-03-14 12:55:07,960 - train_num: 25
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - decay_boundaries: [10, 16, 22]
Training: 2025-03-14 12:55:07,960 - decay_boundaries: [10, 16, 22]
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - use_synthetic_dataset: False
Training: 2025-03-14 12:55:07,960 - use_synthetic_dataset: False
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - dataset: custom_dataset
Training: 2025-03-14 12:55:07,960 - dataset: custom_dataset
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
Training: 2025-03-14 12:55:07,960 - data_dir: /workspace/datasets/manually-annotated/paddlepaddle_data/images/
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
Training: 2025-03-14 12:55:07,960 - label_file: /workspace/datasets/manually-annotated/paddlepaddle_data/train_label.txt
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - is_bin: False
Training: 2025-03-14 12:55:07,960 - is_bin: False
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - num_classes: 312
Training: 2025-03-14 12:55:07,960 - num_classes: 312
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - batch_size: 32
Training: 2025-03-14 12:55:07,960 - batch_size: 32
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - num_workers: 8
Training: 2025-03-14 12:55:07,960 - num_workers: 8
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - do_validation_while_train: False
Training: 2025-03-14 12:55:07,960 - do_validation_while_train: False
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - validation_interval_step: 2000
Training: 2025-03-14 12:55:07,960 - validation_interval_step: 2000
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
Training: 2025-03-14 12:55:07,960 - val_targets: ['lfw', 'cfp_fp', 'agedb_30']
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - logdir: ./log
Training: 2025-03-14 12:55:07,960 - logdir: ./log
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - log_interval_step: 100
Training: 2025-03-14 12:55:07,960 - log_interval_step: 100
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - output: MS1M_v3_arcface_static_0.1
Training: 2025-03-14 12:55:07,960 - output: MS1M_v3_arcface_static_0.1
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - resume: False
Training: 2025-03-14 12:55:07,960 - resume: False
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - checkpoint_dir: None
Training: 2025-03-14 12:55:07,960 - checkpoint_dir: None
[2025-03-14 12:55:07,960] [    INFO] argparser.py:24 - max_num_last_checkpoint: 1
Training: 2025-03-14 12:55:07,960 - max_num_last_checkpoint: 1
[2025-03-14 12:55:07,961] [    INFO] argparser.py:25 - ------------------------

Training: 2025-03-14 12:55:07,961 - ------------------------

[2025-03-14 12:55:07,979] [    INFO] common_dataset.py:55 - read label file finished, total num: 7182
Training: 2025-03-14 12:55:07,979 - read label file finished, total num: 7182
[2025-03-14 12:55:07,979] [    INFO] train.py:80 - world_size: 1
Training: 2025-03-14 12:55:07,979 - world_size: 1
[2025-03-14 12:55:07,980] [    INFO] train.py:81 - total_batch_size: 32
Training: 2025-03-14 12:55:07,980 - total_batch_size: 32
[2025-03-14 12:55:07,980] [    INFO] train.py:82 - warmup_steps: 0
Training: 2025-03-14 12:55:07,980 - warmup_steps: 0
[2025-03-14 12:55:07,980] [    INFO] train.py:83 - steps_per_epoch: 224
Training: 2025-03-14 12:55:07,980 - steps_per_epoch: 224
[2025-03-14 12:55:07,980] [    INFO] train.py:84 - total_steps: 5600
Training: 2025-03-14 12:55:07,980 - total_steps: 5600
[2025-03-14 12:55:07,980] [    INFO] train.py:85 - total_epoch: 25
Training: 2025-03-14 12:55:07,980 - total_epoch: 25
[2025-03-14 12:55:07,980] [    INFO] train.py:86 - decay_steps: [2240, 3584, 4928]
Training: 2025-03-14 12:55:07,980 - decay_steps: [2240, 3584, 4928]
I0314 12:55:11.959652 561186 program_interpreter.cc:212] New Executor is Running.
W0314 12:55:12.048595 561186 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.6, Driver API Version: 12.8, Runtime API Version: 11.8
W0314 12:55:12.050963 561186 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
I0314 12:55:16.955220 561186 interpreter_util.cc:624] Standalone Executor is Used.
Traceback (most recent call last):
  File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
    train(args)
  File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 202, in train
    loss_v = exe.run(
             ^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1746, in run
    res = self._run_impl(
          ^^^^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 1952, in _run_impl
    ret = new_exe.run(
          ^^^^^^^^^^^^
  File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/executor.py", line 831, in run
    tensors = self._new_exe.run(
              ^^^^^^^^^^^^^^^^^^
ValueError: In user code:

    File "/workspace/src/insightface/recognition/arcface_paddle/tools/train.py", line 35, in <module>
      train(args)
    File "/workspace/src/insightface/recognition/arcface_paddle/static/train.py", line 100, in train
      train_model = StaticModel(
    File "/workspace/src/insightface/recognition/arcface_paddle/static/static_model.py", line 114, in __init__
      self.optimizer.minimize(self.classifier.output_dict["loss"])
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 675, in minimize
      optimize_ops = self.apply_optimize(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 639, in apply_optimize
      optimize_ops = self.apply_gradients(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 480, in apply_gradients
      found_inf = self._check_finite_and_unscale(params_grads)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/decorator.py", line 556, in _check_finite_and_unscale
      _, found_inf = check_finite_and_unscale(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/static/amp/amp_nn.py", line 58, in check_finite_and_unscale
      helper.append_op(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/layer_helper.py", line 44, in append_op
      return self.main_program.current_block().append_op(*args, **kwargs)
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 4467, in append_op
      op = Operator(
    File "/workspace/paddlepaddle/lib/python3.12/site-packages/paddle/base/framework.py", line 3016, in __init__
      for frame in traceback.extract_stack():

    InvalidArgumentError: The DataType of check_finite_and_unscale Op's duplicable or different slot Variable X must be consistent or register GetExpectedKernelType. The current variable type is (float), but the previous variable type is (::paddle::platform::float16). (at /paddle/paddle/fluid/framework/operator.cc:2886)
      [operator < check_finite_and_unscale > error]
